<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>jetpack | Rxbby</title><meta name="author" content="Pn,change125800@gmail.com"><meta name="copyright" content="Pn"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Android_Java_Version 一些有用但不知道放哪个位置的知识补充1.将需要用到的图片拖入drawable 2.因为用到数据绑定所以添加依赖 1234567891011android &amp;#123;        ...     buildFeatures &amp;#123;        dataBinding &#x3D;true    &amp;#125;    &amp;#125;dependencies &amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="jetpack">
<meta property="og:url" content="https://changettto.github.io/2023/11/25/jetpack/index.html">
<meta property="og:site_name" content="Rxbby">
<meta property="og:description" content="Android_Java_Version 一些有用但不知道放哪个位置的知识补充1.将需要用到的图片拖入drawable 2.因为用到数据绑定所以添加依赖 1234567891011android &amp;#123;        ...     buildFeatures &amp;#123;        dataBinding &#x3D;true    &amp;#125;    &amp;#125;dependencies &amp;#">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://rxbby.oss-cn-guangzhou.aliyuncs.com/HuiYuan.jpg">
<meta property="article:published_time" content="2023-11-25T08:04:01.000Z">
<meta property="article:modified_time" content="2024-01-24T09:23:35.982Z">
<meta property="article:author" content="Pn">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rxbby.oss-cn-guangzhou.aliyuncs.com/HuiYuan.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://changettto.github.io/2023/11/25/jetpack/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'jetpack',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-24 17:23:35'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/HuiYuan.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.pinimg.com/originals/bf/da/38/bfda380e49cf7b40513372ff07985c20.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Rxbby"><span class="site-name">Rxbby</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">jetpack</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-25T08:04:01.000Z" title="发表于 2023-11-25 16:04:01">2023-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-24T09:23:35.982Z" title="更新于 2024-01-24 17:23:35">2024-01-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="jetpack"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Android-Java-Version"><a href="#Android-Java-Version" class="headerlink" title="Android_Java_Version"></a>Android_Java_Version</h1><p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/3f6702200fe85286634e7f5846ab21a3367514778.png%40!web-comment-note.avif" alt="img"></p>
<h1 id="一些有用但不知道放哪个位置的知识补充"><a href="#一些有用但不知道放哪个位置的知识补充" class="headerlink" title="一些有用但不知道放哪个位置的知识补充"></a><strong>一些有用但不知道放哪个位置的知识补充</strong></h1><p>1.将需要用到的图片拖入drawable</p>
<p>2.因为用到<strong>数据绑定</strong>所以添加依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">        ...</span><br><span class="line">     buildFeatures &#123;</span><br><span class="line">        dataBinding =<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">dependencies &#123;</span><br><span class="line">   ... ... ...</span><br><span class="line">   implementation(platform(<span class="string">&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;</span>))<span class="comment">//这一段代码</span></span><br><span class="line">   ... ... ...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>3.因为要在v-model中暂时保存数据，所以添加viewmodel-savedstat依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation (<span class="string">&quot;androidx.lifecycle:lifecycle-viewmodel-savedstate:2.5.1&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>4.将Fragments的布局全部改为constraintlayout</p>
<p>5.<code>%d</code>的效果是,因为这段话后面要动态的去放置一个数，所以用<code>%d</code>来占位，在databinding的时候就可以传递进去一个数</p>
<p>d:int类型，s：字符串类型</p>
<p><code>%1$d</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;high_score_message&quot;</span>&gt;</span>High Score:%d<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"> android:text=&quot;@&#123;@string/high_score_message(data.getHighScore())&#125;&quot;以这种方式替换掉:%d</span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;question_mark&quot;</span>&gt;</span>\?<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">\? 是为了能够正确的表示?，不被误解</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>6.xml文件中data.operator其实就是data.getOperator()</p>
<p>7.创建ViewModel</p>
<p><code>AndroidViewModel:</code>为了能够访问应用的全局资源。</p>
<p><code>handle:</code>用来存放数据</p>
<p>​	handle的使用通常是与 Android 架构组件的 ViewModel 和 LiveData 配合使用的一个实践。</p>
<p>​	handle的具体用途可能是将 <code>LiveData</code> 放置在 <code>ViewModel</code> 中，<strong>让model中的数据能够有一个监听效果</strong>，并且与 <code>ViewModel</code> 的其	他部分隔离。这是一种良好的做法，因为 <code>ViewModel</code> 是设计用于存储和管理与界面相关的数据的。</p>
<p>8.<strong>输入框内有文本时按钮才生效</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TextWatcher textWatcher=<span class="keyword">new</span> <span class="title class_">TextWatcher</span>() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeTextChanged</span><span class="params">(CharSequence charSequence, <span class="type">int</span> i, <span class="type">int</span> i1, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">//当文本框里的内容发生改变时</span></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onTextChanged</span><span class="params">(CharSequence charSequence, <span class="type">int</span> i, <span class="type">int</span> i1, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">               <span class="type">String</span> <span class="variable">chinese</span> <span class="operator">=</span> EditTextChinese.getText().toString().trim();</span><br><span class="line">               <span class="type">String</span> <span class="variable">english</span> <span class="operator">=</span> EditTextEnglish.getText().toString().trim();</span><br><span class="line">               <span class="comment">//如果有内容了就能够使用按钮</span></span><br><span class="line">               buttonSubmit.setEnabled(!english.isEmpty()&amp;&amp; !chinese.isEmpty());</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterTextChanged</span><span class="params">(Editable editable)</span> &#123;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;;</span><br><span class="line">       EditTextChinese.addTextChangedListener(textWatcher);</span><br><span class="line">       EditTextEnglish.addTextChangedListener(textWatcher);</span><br><span class="line">       <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h1 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h1><h2 id="Context和ApplicationContext"><a href="#Context和ApplicationContext" class="headerlink" title="Context和ApplicationContext"></a><strong>Context和ApplicationContext</strong></h2><ol>
<li><strong>生命周期：</strong><ul>
<li><code>Context</code> 是一个抽象类，它是 Android 应用程序中各个组件（Activity、Service、BroadcastReceiver等）的基类。每个组件都会有自己的 <code>Context</code>。</li>
<li><code>ApplicationContext</code> 是 <code>Context</code> 的一种具体实现，它表示应用程序的整个生命周期。通常，你可以通过 <code>getApplicationContext()</code> 方法获取应用程序的上下文。</li>
</ul>
</li>
<li><strong>生命周期范围：</strong><ul>
<li><code>Context</code> 的生命周期与相应的组件（Activity、Service等）密切相关。例如，在 Activity 销毁时，与该 Activity 相关的 Context 也会被销毁。</li>
<li><code>ApplicationContext</code> 的生命周期与整个应用程序生命周期相同，它在应用程序启动时创建，在应用程序关闭时销毁。</li>
<li>也就是说应用回到主页面或者翻转手机时不会被销毁</li>
</ul>
</li>
<li><strong>内存泄漏：</strong><ul>
<li>由于 <code>Context</code> 可能持有对 Activity 的引用，如果在长时间运行的任务中持有了 Activity 的引用，可能导致内存泄漏。</li>
<li><code>ApplicationContext</code> 的生命周期更长，通常情况下不容易引发内存泄漏，因为它的生命周期与应用程序一致。</li>
</ul>
</li>
<li><strong>获取方式：</strong><ul>
<li>你可以在 Activity 中直接使用 <code>this</code> 或者 <code>getBaseContext()</code> 来获取 <code>Context</code>。</li>
<li>你可以在任何地方使用 <code>getApplicationContext()</code> 来获取应用程序的上下文。</li>
</ul>
</li>
</ol>
<p>总体而言，如果你需要一个长时间存活的上下文，并且不会导致内存泄漏，通常会选择使用 <code>ApplicationContext</code>。在大多数情况下，使用 <code>Activity</code> 的上下文是安全的，但需要小心在长时间运行的任务中引用它，以免产生内存泄漏问题。</p>
<h1 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h1><ul>
<li><code>Application</code> 类是 Android 应用程序的基类，每个 Android 应用程序都有一个与之相关联的 <code>Application</code> 类。</li>
<li>它是一个全局的单例，通常在应用程序启动时被创建，用于维护应用程序级别的状态和全局配置。</li>
<li>你可以通过在 AndroidManifest.xml 文件中指定 <code>android:name</code> 属性来定义自己的 <code>Application</code> 类，或者使用默认的系统 <code>Application</code>。</li>
<li><code>Application</code> 类通常用于初始化应用程序范围的资源，处理应用程序的生命周期事件，以及存储全局状态。</li>
</ul>
<h1 id="Constraint-layout"><a href="#Constraint-layout" class="headerlink" title="Constraint layout"></a>Constraint layout</h1><h2 id="palette调色板"><a href="#palette调色板" class="headerlink" title="palette调色板"></a><strong>palette</strong>调色板</h2><p>TextView:普通文本框，显示文字</p>
<p>ImageView: 图片框</p>
<p>Plain Text: 输入框，点击之后会弹出一个完整键盘</p>
<p>Password: 密码输入框</p>
<p>Button: 按钮</p>
<p>Switch:开关</p>
<p>Number: 输入框，点击之后只会弹出数字键盘</p>
<p>Phone:输入框，点击之后是拨号键盘</p>
<p>RedioButton: 一个单选按钮，选择之后变红无法复原，所以一般是放在一个RedioGroup中，形成一个互斥效果，选择一个另一个就不能再次选择。  将cheaked设置为ture将会有一个默认值</p>
<p>ToggleButton:一个类似于手电筒开关的按钮，动画效果是按一次就下去再按一次就弹出来</p>
<p>ProgressBar: 一个进度条式的一个圆圈一直在转</p>
<p>ProgressBar（水平）：一个水平的进度条，Progress设置为30会填充30％的进度。可以反复读。将属性indeterminate设置为true可达到读条的效果</p>
<p>SeekBar: 也是一个进度条，但是这个进度条相当于调节亮度那个，自己滑动，滑动的时候Progress会动态变化。</p>
<p>SeekBar(Discrete): 中间有很多小点的离散的SeekBar</p>
<p>RatingBar: 就是那种打分，五颗心</p>
<h2 id="Attributes"><a href="#Attributes" class="headerlink" title="Attributes"></a><strong>Attributes</strong></h2><p><strong>layout_width&#x2F;heigth：</strong>设置组件的宽高</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wrap_content: 可以随着里面的内容的大小而动态的改变大小</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Activity-生命周期"><a href="#Activity-生命周期" class="headerlink" title="Activity 生命周期"></a>Activity 生命周期</h1><p>一个应用程序由多个Activity 来组成，每一个Activity 就是一个单独的功能</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231121205504034.png" alt="image-20231121205504034" style="zoom:50%;" />

<p><code>OnCreate</code>:当Activity启动时调用时调用，作用是创建这个对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span></span><br></pre></td></tr></table></figure>

<p>​	<code>savedInstanceState</code>该参数用来传递Activity所保存的一些数据。</p>
<p><code>OnStart</code>:当Activity呈现在屏幕上时调用，但此时Activity还没用正式的和用户进行交互。</p>
<p><code>OnResume</code>:当所有资源准备好并且可以接受用户的动作了，会调用，调用完成之后Activity会进入运行阶段。</p>
<p><code>onPause</code>:当其他Activity进入前台时，原来的Activity会调用此函数，并进入一个暂停的阶段。此时还是可见的。</p>
<p><code>onStop</code>:在暂停之后如果应用切换到了后台，那么会调用这个函数，进入到停止阶段。此时Activity不可见。</p>
<p><code>onDestroy</code>:当用代码或者系统将该Activity停止掉后，那么会调用这个函数。关闭该Activity</p>
<ul>
<li><p>屏幕翻转时会将其杀死并重新创建并启动，所以应该在退出之前保存用户信息</p>
</li>
<li><p>finsh()函数会立即杀死Activity</p>
</li>
<li><p>切换手机语言也会杀死并重启</p>
</li>
<li><p>手机按返回键</p>
</li>
</ul>
<h1 id="Activity方法"><a href="#Activity方法" class="headerlink" title="Activity方法"></a>Activity方法</h1><h2 id="onSaveInstanceState"><a href="#onSaveInstanceState" class="headerlink" title="onSaveInstanceState"></a><strong>onSaveInstanceState</strong></h2><p>用于<strong>临时</strong>保存当前活动（Activity）的状态信息。通常在活动即将被销毁之前被调用，例如当用户旋转设备屏幕时，或者在系统需要释放内存时。按返回键就彻底丢失了，翻转屏幕或者按home键还是会存在</p>
<p><code>Bundle</code>键值对类型的数据结构，当作map看待</p>
<p><strong>存：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onSaveInstanceState</span><span class="params">(<span class="meta">@NonNull</span> Bundle outState)</span> &#123;</span><br><span class="line">      <span class="built_in">super</span>.onSaveInstanceState(outState);</span><br><span class="line">      <span class="comment">//这样的话就将信息保存到Bundle中了</span></span><br><span class="line">      outState.putString(<span class="string">&quot;KEY&quot;</span>,editText.getText().toString());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>取：</strong>Bundle.getString(“KEY”);</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (savedInstanceState!=<span class="literal">null</span>)&#123;</span><br><span class="line">            String s=savedInstanceState.getString(<span class="string">&quot;KEY&quot;</span>);</span><br><span class="line">            editText.setText(s);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>



<hr>
<h1 id="UI控件"><a href="#UI控件" class="headerlink" title="UI控件"></a>UI控件</h1><p>控件就是用户和手机交互接触到的所有对象—&gt;比如<strong>palette</strong></p>
<p>在MVC设计模式中Model-View-Controller控件就属于View.</p>
<p>每一个控件都有一个id，那么控制逻辑就是根据这个ID建立关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setVisibility(View.VISIBLE);  <span class="comment">//控制</span></span><br></pre></td></tr></table></figure>

<p><strong>一个简单的与控件进行交互的例子</strong></p>
<p>在我们调用pause函数后会改变Text的内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    TextView textView;  <span class="comment">//引入对应的控件</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="comment">//将控件通过ID进行绑定，R代表res目录下的资源</span></span><br><span class="line">        textView=findViewById(R.id.textView);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        textView.setText(R.string.button_msg);<span class="comment">//在暂停时改变文字</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="为button设置一个点击事件监听器"><a href="#为button设置一个点击事件监听器" class="headerlink" title="为button设置一个点击事件监听器"></a>为button设置一个点击事件监听器</h2><p><strong>setOnClickListener</strong> 无参</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                textView.setText(<span class="string">&quot;左边&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//可简化为</span></span><br><span class="line">button.setOnClickListener(view -&gt; textView.setText(<span class="string">&quot;左边&quot;</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">buttonSubmit.setEnabled(<span class="literal">false</span>);<span class="comment">//按钮初始状态不可按</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Switch监听改变事件"><a href="#Switch监听改变事件" class="headerlink" title="Switch监听改变事件"></a>Switch监听改变事件</h2><p><strong>setOnCheckedChangeListener</strong></p>
<p>参数b为true时就是开启状态</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  aSwitch.setOnCheckedChangeListener(<span class="keyword">new</span> <span class="title class_">CompoundButton</span>.OnCheckedChangeListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCheckedChanged</span><span class="params">(CompoundButton compoundButton, <span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(b)&#123;</span><br><span class="line">                    display.setText(<span class="string">&quot;开&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    display.setText(<span class="string">&quot;关&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="comment">//可简化为</span></span><br><span class="line"> aSwitch.setOnCheckedChangeListener((compoundButton, b) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span>(b)&#123;</span><br><span class="line">                display.setText(<span class="string">&quot;开&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                display.setText(<span class="string">&quot;关&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">switchChinese.setChecked(<span class="literal">true</span>);<span class="comment">//默认就是打开状态</span></span><br></pre></td></tr></table></figure>



<h2 id="radioGroup监听事件"><a href="#radioGroup监听事件" class="headerlink" title="radioGroup监听事件"></a>radioGroup监听事件</h2><p><strong>setOnCheckedChangeListener</strong> 有参</p>
<p>参数i代表选中的是几号radio</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">radioGroup.setOnCheckedChangeListener(<span class="keyword">new</span> <span class="title class_">RadioGroup</span>.OnCheckedChangeListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="comment">//i表示选中的是第几号Radio</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCheckedChanged</span><span class="params">(RadioGroup radioGroup, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">               <span class="keyword">if</span> (i==R.id.radioButton)&#123;</span><br><span class="line">                   imageView.setImageResource(R.drawable.x);</span><br><span class="line">               &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                   imageView.setImageResource(R.drawable.y);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>



<h2 id="seekBar监听事件"><a href="#seekBar监听事件" class="headerlink" title="seekBar监听事件"></a><strong>seekBar监听事件</strong></h2><p>  <strong>seekBar.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener()</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">seekBar.setOnSeekBarChangeListener(<span class="keyword">new</span> <span class="title class_">SeekBar</span>.OnSeekBarChangeListener() &#123;</span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="comment">//当滑动值改变时，i为改变的值，b表示进度的变化是否是由用户手动操作触发的。</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onProgressChanged</span><span class="params">(SeekBar seekBar, <span class="type">int</span> i, <span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">               display.setText(String.valueOf(i));</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStartTrackingTouch</span><span class="params">(SeekBar seekBar)</span> &#123;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStopTrackingTouch</span><span class="params">(SeekBar seekBar)</span> &#123;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure>



<h2 id="checkedBox监听事件"><a href="#checkedBox监听事件" class="headerlink" title="checkedBox监听事件"></a>checkedBox监听事件</h2><p><strong>setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener()</strong></p>
<p><strong>参数b代表是否选中</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yuwen.setOnCheckedChangeListener(<span class="keyword">new</span> <span class="title class_">CompoundButton</span>.OnCheckedChangeListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCheckedChanged</span><span class="params">(CompoundButton compoundButton, <span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">               <span class="keyword">if</span>(b)&#123;</span><br><span class="line">                   yu=<span class="string">&quot;语文&quot;</span>;</span><br><span class="line">               &#125;</span><br><span class="line">               display.setText(yu+shu+ying);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>



<h2 id="progressBar"><a href="#progressBar" class="headerlink" title="progressBar"></a>progressBar</h2><p><strong>将该值给到progressBar</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">button3.setOnClickListener(view -&gt; &#123;</span><br><span class="line">          String s= editText.getText().toString();  <span class="comment">//从输入框中获取一个值</span></span><br><span class="line">          <span class="keyword">if</span>(TextUtils.isEmpty(s))&#123;</span><br><span class="line">              s=<span class="string">&quot;0&quot;</span>;    <span class="comment">//如果这个值为空，那么就给一个默认值</span></span><br><span class="line">          &#125;</span><br><span class="line">        <span class="comment">//将字符串转为整型，并将该值给到progressBar,后面的参数可以给个true，有过渡动画</span></span><br><span class="line">          progressBar.setProgress(Integer.valueOf(s));</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h2><p><strong>从输入框中获取一个值</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String s= editText.getText().toString();  <span class="comment">//从输入框中获取一个值</span></span><br></pre></td></tr></table></figure>



<h2 id="imageView"><a href="#imageView" class="headerlink" title="imageView"></a>imageView</h2><p><strong>设置img对象的图片来源</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imageView.setImageResource(R.drawable.x);</span><br></pre></td></tr></table></figure>

<p><strong>dimensionratio</strong>设置图片长宽比</p>
<h2 id="TextView-plain-View"><a href="#TextView-plain-View" class="headerlink" title="TextView-plain-View"></a>TextView-plain-View</h2><p><strong>接收一个字符串</strong></p>
<p><code>扳手text:</code> 只是在设计阶段设置的值，并不会展现到真正的应用上。</p>
<p><code>textcolor:</code>设置文本颜色</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EditTextEnglish.getText() 返回的是 Editable 对象，而调用 toString() 方法是为了将 Editable 转换为字符串。</span></span><br><span class="line"><span class="comment">//trim切掉前后的空格</span></span><br><span class="line"><span class="type">String</span> <span class="variable">english</span> <span class="operator">=</span> EditTextEnglish.getText().toString().trim();</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//强制弹出键盘，并将焦点放到空间视图上 </span></span><br><span class="line">EditTextEnglish.requestFocus();<span class="comment">//获取焦点</span></span><br><span class="line"> <span class="type">InputMethodManager</span> <span class="variable">imm</span>  <span class="operator">=</span> (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);</span><br><span class="line"> imm.showSoftInput(EditTextEnglish,<span class="number">0</span>);<span class="comment">//强制显示键盘，参数一，键盘和哪个参数挂钩</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//如果返回之后键盘还是缩不回去那么添加</span></span><br><span class="line">imm.hideSoftInputFromWindow(view.getWindowToken(),<span class="number">0</span>);</span><br></pre></td></tr></table></figure>



<h2 id="ratingBar监听事件"><a href="#ratingBar监听事件" class="headerlink" title="ratingBar监听事件"></a>ratingBar监听事件</h2><p>v就代表几颗星</p>
<p>b代表是否选中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ratingBar.setOnRatingBarChangeListener(<span class="keyword">new</span> <span class="title class_">RatingBar</span>.OnRatingBarChangeListener()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onRatingChanged</span><span class="params">(RatingBar ratingBar, <span class="type">float</span> v, <span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">                Toast.makeText(getApplicationContext(),String.valueOf(v),Toast.LENGTH_LONG).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>







<h2 id="ImageButton"><a href="#ImageButton" class="headerlink" title="ImageButton"></a>ImageButton</h2><p>在使用矢量图时需要为button的属性<code>contentDescription</code>设置一个值。</p>
<p><strong>contentDescription</strong>:也就是当使用无障碍时，点击这个图片会朗读contentDescription的内容。</p>
<p><strong>监听事件</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">imageButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">          <span class="meta">@Override</span></span><br><span class="line">          <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">              myViewModelWithLiveData.addLikedNumber(<span class="number">1</span>);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure>



<h2 id="Chronometer计时器"><a href="#Chronometer计时器" class="headerlink" title="Chronometer计时器"></a>Chronometer计时器</h2><p>是TextView的一个子类，直接将原来的TextView标签改为Chronometer就行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设定计时的一个起点。</span></span><br><span class="line">chronometer.setBase(System.currentTimeMillis()); <span class="comment">//UNIX时间  1970 1 - 1 开始</span></span><br><span class="line">chronometer.setBase(SystemClock.elapsedRealtime()); <span class="comment">//手机从启动应用开始的时间</span></span><br><span class="line">chronometer.stop();<span class="comment">//暂停计时</span></span><br></pre></td></tr></table></figure>

<p><strong>按理说下面的代码，在返回主菜单的时候会暂停计数，回到应用的时候会继续计数，但实际情况却是回到应用的时候发现它在主菜单的时候依然会继续计数，没有进行暂停。</strong></p>
<p>其实这个chronometer一但创建就开始计数了，并且会一直记下去。无论是stop还是start都只是控制它是否要将记下来的数显示到屏幕上而已。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">        Chronometer chronometer;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        chronometer= findViewById(R.id.meter);</span><br><span class="line">        <span class="comment">//设定计时的一个起点。</span></span><br><span class="line">        chronometer.setBase(SystemClock.elapsedRealtime()); <span class="comment">//手机从启动应用开始到现在的时间</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        chronometer.stop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        chronometer.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更正</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">        Chronometer chronometer;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">long</span> time;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        chronometer= findViewById(R.id.meter);</span><br><span class="line">        <span class="comment">//设定计时的一个起点。</span></span><br><span class="line">        chronometer.setBase(SystemClock.elapsedRealtime()); <span class="comment">//手机从启动应用开始到现在的时间</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        <span class="comment">//暂停的时候time等于打开应用到暂停的的时间减去刚开始计时的时间。</span></span><br><span class="line">        time=SystemClock.elapsedRealtime()-chronometer.getBase();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        chronometer.setBase(SystemClock.elapsedRealtime()-time);</span><br><span class="line">        chronometer.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="RecyclerView"><a href="#RecyclerView" class="headerlink" title="RecyclerView"></a>RecyclerView</h2><blockquote>
<p>实际可参考RoomBasic项目</p>
</blockquote>
<p>把每一个View.xml放到这个RecyclerView中，当滚动屏幕时，不在屏幕上的数据将会被回收，就不用一次展示那么多了。</p>
<p><code>RecyclerView</code>是用于显示大量数据集合的高性能控件，它允许你以灵活的方式展示和管理列表、网格等布局。<code>RecyclerView</code>需要使用适配器（Adapter）来提供数据并协调数据和UI之间的交互。</p>
<p><strong>1.主视图中创建一个RecyclerView</strong></p>
<p><strong>2.res中创建一个Layout文件，布局为ConstrantLayout</strong></p>
<p><strong>3.创建设配器public class MyAdapter extends RecyclerView.Adapter</strong></p>
<p>适配器的作用主要有以下几点：</p>
<ol>
<li><strong>数据绑定：</strong> 适配器负责将数据集合绑定到<code>RecyclerView</code>上。通过适配器，你可以将数据源（比如一个列表或数据库查询结果）与<code>RecyclerView</code>关联起来。</li>
<li><strong>创建和管理视图：</strong> 适配器负责创建<code>RecyclerView</code>中每个数据项的视图（View），通常通过创建<code>ViewHolder</code>来实现。<code>ViewHolder</code>是一个持有视图引用的对象，它可以在<code>RecyclerView</code>滚动时重复使用，提高性能。</li>
<li><strong>定义数据项的布局：</strong> 适配器负责定义每个数据项在<code>RecyclerView</code>中的布局。这包括决定每个数据项使用哪个布局文件，以及如何显示数据。</li>
<li><strong>处理用户输入和交互：</strong> 适配器可以处理用户输入事件，例如点击某个数据项时的响应。通过适配器，你可以为<code>RecyclerView</code>中的每个数据项定义相应的交互逻辑。</li>
<li><strong>支持动画和更新：</strong> 当数据集合发生变化时，适配器负责通知<code>RecyclerView</code>进行更新。这包括插入、删除、移动等操作，适配器会处理这些变化并触发相应的动画效果。</li>
</ol>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231208133809959.png"></p>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231208133824725.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RecyclerView recyclerView=getView().findViewById(R.id.RecylerView);  <span class="comment">//todo getView换成requireActivity()</span></span><br><span class="line">recyclerView.setLayoutManager(<span class="keyword">new</span> <span class="title class_">LinearLayoutManager</span>(requireActivity()));<span class="comment">//一维列表所以用这个</span></span><br><span class="line">myAdapter1 =<span class="keyword">new</span> <span class="title class_">MyAdapter</span>(<span class="literal">false</span>,myViewModel);</span><br><span class="line">recyclerView.setAdapter(myAdapter1);</span><br><span class="line">MyAdapter(<span class="type">boolean</span> useCardView,MyViewModel myViewModel)&#123;</span><br><span class="line">        <span class="built_in">this</span>.useCardView=useCardView;</span><br><span class="line">        <span class="built_in">this</span>.myViewModel=myViewModel;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdapter</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.Adapter&lt;MyAdapter.MyViewHolder&gt; &#123;</span><br><span class="line">    List&lt;Word&gt; allWords = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAllWords</span><span class="params">(List&lt;Word&gt; allWords)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.allWords = allWords;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *当创建时调用</span></span><br><span class="line"><span class="comment">     * 需要返回一个ViewHolder</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MyViewHolder <span class="title function_">onCreateViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup parent, <span class="type">int</span> viewType)</span> &#123;</span><br><span class="line">        <span class="type">LayoutInflater</span> <span class="variable">layoutInflater</span> <span class="operator">=</span> LayoutInflater.from(parent.getContext());</span><br><span class="line">        <span class="comment">//与Cell进行一个绑定</span></span><br><span class="line">        <span class="type">View</span> <span class="variable">itemView</span> <span class="operator">=</span>layoutInflater.inflate(R.layout.cell_normal,parent,<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//创建一个ViewHolder</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyViewHolder</span>(itemView);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *当自订的ViewHolder和RecyclerView进行绑定时调用</span></span><br><span class="line"><span class="comment">     * 屏幕上每展示出一个ViewHolder就会调用该方法进行一个数据的查找和绑定</span></span><br><span class="line"><span class="comment">     * 在 RecyclerView 在屏幕上滚动时，新的列表项需要显示在屏幕上时触发的。</span></span><br><span class="line"><span class="comment">     * 这个方法将在数据集中的每个列表项滚动到屏幕内时被调用，用于将数据绑定到相应的 ViewHolder 上，以便更新列表项的视图。</span></span><br><span class="line"><span class="comment">     * myAdapter.notifyDataSetChanged();数据发生改变，通知刷新视图,让onBindViewHolder 方法被调用</span></span><br><span class="line"><span class="comment">     * position就是</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBindViewHolder</span><span class="params">(<span class="meta">@NonNull</span> MyViewHolder holder, <span class="type">int</span> position)</span> &#123;</span><br><span class="line">            <span class="type">Word</span> <span class="variable">word</span> <span class="operator">=</span> allWords.get(position);<span class="comment">//position作为下标获取word对象</span></span><br><span class="line">             <span class="comment">//将数据库中的数据绑定到组件上</span></span><br><span class="line">            holder.number.setText(String.valueOf(position + <span class="number">1</span>));  <span class="comment">//当前位置加1，因为是从0开始的</span></span><br><span class="line">            holder.english.setText(word.getWord());</span><br><span class="line">            holder.chinese.setText(word.getChineseMeaning());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回列表数据的总的个数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> allWords.size();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 展示的一行数据一个视图就是一个ViewHolder,滚动出屏幕就会被回收，在下面显示出来一个新的ViewHolder就会被重复使用</span></span><br><span class="line"><span class="comment">     * 每次重复放到一个新的位置上就会呼叫一次onBindViewHolder获取数据并显示到ViewHolder中</span></span><br><span class="line"><span class="comment">     一个item就是一个ViewHolder类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyViewHolder</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.ViewHolder&#123;</span><br><span class="line">        TextView number,english,chinese;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MyViewHolder</span><span class="params">(<span class="meta">@NonNull</span> View itemView)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(itemView);</span><br><span class="line">            number=itemView.findViewById(R.id.number);</span><br><span class="line">            english=itemView.findViewById(R.id.english);</span><br><span class="line">            chinese=itemView.findViewById(R.id.chinese);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>4.创建一个ViewHolder用来管理res中Layout.xml的组件</strong></p>
<p><code>ViewHolder</code>是一种设计模式，通常与<code>Adapter</code>一起使用，特别是在<code>RecyclerView</code>中。<code>ViewHolder</code>的主要作用是优化<code>ListView</code>、<code>GridView</code>、<code>RecyclerView</code>等列表型控件的性能。</p>
<p>当用户滚动列表时，会涉及到大量的视图创建和销毁操作，如果每次都重新创建新的视图，会导致性能问题。<code>ViewHolder</code>的主要目的就是缓存这些视图的引用，避免重复查找和创建，提高列表滚动的性能。</p>
<p>在<code>RecyclerView</code>中，<code>ViewHolder</code>是一个内部类，通常定义在适配器（Adapter）的内部。它包含了对列表项布局中各个视图的引用。<code>ViewHolder</code>通常具有以下作用：</p>
<ol>
<li><strong>减少<code>findViewById</code>的调用次数：</strong> 在<code>ViewHolder</code>中保存<code>itemView</code>（列表项的视图），并通过<code>findViewById</code>在<code>ViewHolder</code>中查找各个子视图，可以避免每次滚动时都调用<code>findViewById</code>，提高性能。</li>
<li><strong>缓存视图引用：</strong> <code>ViewHolder</code>会缓存列表项中的各个视图的引用，避免重复的视图创建，提高列表滚动时的性能。</li>
<li><strong>提供对视图的直接访问：</strong> 通过<code>ViewHolder</code>，你可以直接访问列表项布局中的各个子视图，而不必每次都通过<code>findViewById</code>查找。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyViewHolder</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.ViewHolder&#123;</span><br><span class="line">       TextView number,english,chinese;</span><br><span class="line">       <span class="keyword">public</span> <span class="title function_">MyViewHolder</span><span class="params">(<span class="meta">@NonNull</span> View itemView)</span> &#123;</span><br><span class="line">           <span class="built_in">super</span>(itemView);</span><br><span class="line">           number=itemView.findViewById(R.id.number);</span><br><span class="line">           english=itemView.findViewById(R.id.english);</span><br><span class="line">           chinese=itemView.findViewById(R.id.chinese);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<p><strong>5.在主Activity.java中引用Adapter</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  RecyclerView recyclerView;</span><br><span class="line">  MyAdapter myAdapter;</span><br><span class="line"><span class="comment">//OnCreate</span></span><br><span class="line">recyclerView=findViewById(R.id.RecyclerView);</span><br><span class="line">      myAdapter = <span class="keyword">new</span> <span class="title class_">MyAdapter</span>();</span><br><span class="line">      recyclerView.setLayoutManager(<span class="keyword">new</span> <span class="title class_">LinearLayoutManager</span>(<span class="built_in">this</span>));<span class="comment">//一维列表所以用这个</span></span><br><span class="line">      recyclerView.setAdapter(myAdapter);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数据发生改变就改变textView的值</span></span><br><span class="line">        myViewModel.getAllWordLive().observe(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">Observer</span>&lt;List&lt;Word&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChanged</span><span class="params">(List&lt;Word&gt; words)</span> &#123;</span><br><span class="line">                myAdapter.setAllWords(words);</span><br><span class="line">                myAdapter.notifyDataSetChanged();<span class="comment">//数据发生改变，通知刷新视图</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p><strong>效果</strong></p>
<p>可进行一个滚动</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231126042318758.png" alt="image-20231126042318758" style="zoom:65%;" />

<p>结构</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231126044256189.png" alt="image-20231126044256189" style="zoom:70%;" />

<p><strong>在根布局标签中添加以下代码可获得点击反馈效果</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">	</span><br><span class="line">android:background=&quot;?selectableItemBackground&quot;</span><br><span class="line">    android:clickable=&quot;true&quot;</span><br><span class="line">    android:focusable=&quot;true&quot;</span><br></pre></td></tr></table></figure>

<p><strong>实现点击之后跳转到网页</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在onBindViewHolder中</span></span><br><span class="line">holder.itemView.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                    <span class="type">Uri</span> <span class="variable">uri</span> <span class="operator">=</span> Uri.parse(<span class="string">&quot;https://www.youdao.com/m/result?word=&quot;</span>+holder.english.getText()+<span class="string">&quot;&amp;lang=en&quot;</span>);</span><br><span class="line">                    <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(Intent.ACTION_VIEW);</span><br><span class="line">                    intent.setData(uri);</span><br><span class="line">                    holder.itemView.getContext().startActivity(intent);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="CardView"><a href="#CardView" class="headerlink" title="CardView"></a>CardView</h2><blockquote>
<p>实际可参考RoomBasic项目</p>
</blockquote>
<p>clickable属性:ture可点击</p>
<p>​	配合background: 选择?attr&#x2F;selectableItemBackgroundBorderless 可达到一个选中颜色反馈。</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231126045844952.png" alt="image-20231126045844952" style="zoom:80%;" />

<p><strong>效果</strong></p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231126050321179.png" alt="image-20231126050321179" style="zoom:20%;" />

<p><strong>实现点击反馈效果</strong></p>
<p>在布局标签下添加：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">android:clickable=&quot;true&quot;</span><br><span class="line">   android:focusable=&quot;true&quot;</span><br></pre></td></tr></table></figure>



<p>在CardView标签下添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:foreground=<span class="string">&quot;?selectableItemBackground&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="FloatingActionButton"><a href="#FloatingActionButton" class="headerlink" title="FloatingActionButton"></a>FloatingActionButton</h2><p>如果在Fragment中使用需要调动位置的话还需添加gravity属性，然后再加上一个边距就可以了。</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231128194628467.png" alt="image-20231128194628467" style="zoom:80%;" />



<h2 id="menu菜单布局"><a href="#menu菜单布局" class="headerlink" title="menu菜单布局"></a>menu菜单布局</h2><p>ShowAsAction: always可以将组件放到ActionBar上</p>
<p>主活动中重载这个函数以获得显示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> &#123;</span><br><span class="line">        getMenuInflater().inflate(R.menu.main_menu,menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onCreateOptionsMenu(menu);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>但是呢有个问题，那就是在切换导航的时候任何导航界面都有这个菜单，如何只在某一个界面展示？</p>
<p>–那就是放在对应的界面xml中，如fragment中，同样也有上面的重载方法 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(<span class="meta">@NonNull</span> Menu menu, <span class="meta">@NonNull</span> MenuInflater inflater)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreateOptionsMenu(menu, inflater);</span><br><span class="line">        inflater.inflate(R.menu.main_menu,menu);</span><br><span class="line">        <span class="type">SearchView</span> <span class="variable">searchView</span> <span class="operator">=</span> (SearchView) menu.findItem(R.id.app_bar_search).getActionView();</span><br><span class="line">        searchView.setMaxWidth(<span class="number">800</span>);<span class="comment">//设置搜索栏的宽度</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//然后在构造函数中添加这么一段话</span></span><br><span class="line">setHasOptionsMenu(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<p>搜索框监听器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(<span class="meta">@NonNull</span> Menu menu, <span class="meta">@NonNull</span> MenuInflater inflater)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onCreateOptionsMenu(menu, inflater);</span><br><span class="line">       inflater.inflate(R.menu.main_menu,menu);</span><br><span class="line">       <span class="type">SearchView</span> <span class="variable">searchView</span> <span class="operator">=</span> (SearchView) menu.findItem(R.id.app_bar_search).getActionView();</span><br><span class="line">       searchView.setMaxWidth(<span class="number">800</span>);</span><br><span class="line">       searchView.setOnQueryTextListener(<span class="keyword">new</span> <span class="title class_">SearchView</span>.OnQueryTextListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span><span class="comment">//当提交内容时</span></span><br><span class="line">           <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onQueryTextSubmit</span><span class="params">(String s)</span> &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="meta">@Override</span><span class="comment">//当搜索框文本改变时</span></span><br><span class="line">           <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onQueryTextChange</span><span class="params">(String s)</span> &#123;</span><br><span class="line">               <span class="type">String</span> <span class="variable">pattern</span> <span class="operator">=</span> s.trim();</span><br><span class="line">               filteredWords.removeObservers(requireActivity());<span class="comment">//移除观察，因为前面已经有一个观察了</span></span><br><span class="line">               filteredWords=myViewModel.findWordsWIthPattern(pattern);</span><br><span class="line">               filteredWords.observe(requireActivity(), <span class="keyword">new</span> <span class="title class_">Observer</span>&lt;List&lt;Word&gt;&gt;() &#123;</span><br><span class="line">                   <span class="meta">@Override</span></span><br><span class="line">                   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChanged</span><span class="params">(List&lt;Word&gt; words)</span> &#123;</span><br><span class="line">                       <span class="comment">//如果没有任何的数据更改，在视图层面进行刷新就可以了</span></span><br><span class="line">                       <span class="type">int</span> temp=myAdapter1.getItemCount();</span><br><span class="line">                       myAdapter1.setAllWords(words);</span><br><span class="line">                       myAdapter2.setAllWords(words);</span><br><span class="line">                       <span class="keyword">if</span> (temp!=words.size())&#123;</span><br><span class="line">                           myAdapter1.notifyDataSetChanged();</span><br><span class="line">                           myAdapter2.notifyDataSetChanged();<span class="comment">//数据发生改变，通知刷新视图,让onBindViewHolder 方法被调用</span></span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">               <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//如果事件完成不用往下继续了，就返回true，s就是监听到的内容</span></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>其他的控件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onOptionsItemSelected</span><span class="params">(<span class="meta">@NonNull</span> MenuItem item)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">itemId</span> <span class="operator">=</span> item.getItemId();</span><br><span class="line">        <span class="keyword">if</span> (itemId==R.id.cleanData) &#123;</span><br><span class="line">            <span class="comment">// 获取弹出对话框对象</span></span><br><span class="line">            AlertDialog.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AlertDialog</span>.Builder(requireActivity());</span><br><span class="line">            builder.setTitle(<span class="string">&quot;清空数据&quot;</span>);</span><br><span class="line"></span><br><span class="line">            builder.setPositiveButton(<span class="string">&quot;确定&quot;</span>, <span class="keyword">new</span> <span class="title class_">DialogInterface</span>.OnClickListener() &#123;</span><br><span class="line">                <span class="comment">// 确定执行的语句</span></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(DialogInterface dialogInterface, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">                    myViewModel.deleteAll();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 取消执行的语句</span></span><br><span class="line">            builder.setNegativeButton(<span class="string">&quot;取消&quot;</span>, <span class="keyword">new</span> <span class="title class_">DialogInterface</span>.OnClickListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(DialogInterface dialogInterface, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">                    <span class="comment">// 取消执行的语句</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            builder.create();</span><br><span class="line">            builder.show();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(itemId==R.id.SwitchView)&#123;</span><br><span class="line">            <span class="type">SharedPreferences</span> <span class="variable">shp</span> <span class="operator">=</span> requireActivity().getSharedPreferences(VIEW_TYPE_SHP,Context.MODE_PRIVATE);</span><br><span class="line">            <span class="comment">//从SharedPreferences中读取一个名为IS_USING_CARD_VIEW的布尔值</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">viewType</span> <span class="operator">=</span> shp.getBoolean(IS_USING_CARD_VIEW,<span class="literal">false</span>);</span><br><span class="line">            SharedPreferences.Editor editor= shp.edit();</span><br><span class="line">            <span class="keyword">if</span>(viewType)&#123;</span><br><span class="line">                recyclerView.setAdapter(myAdapter1);</span><br><span class="line">                editor.putBoolean(IS_USING_CARD_VIEW,<span class="literal">true</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                recyclerView.setAdapter(myAdapter2);</span><br><span class="line">                editor.putBoolean(IS_USING_CARD_VIEW,<span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            editor.apply();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onOptionsItemSelected(item);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="属性动画"><a href="#属性动画" class="headerlink" title="属性动画"></a>属性动画</h2><p><strong>旋转</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container,</span></span><br><span class="line"><span class="params">                             <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       View view=inflater.inflate(R.layout.fragment_one, container, <span class="literal">false</span>);</span><br><span class="line">       imageView=view.findViewById(R.id.imageView);</span><br><span class="line">       <span class="keyword">return</span>  view;</span><br><span class="line">    &#125;   </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityCreated</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">        mViewModel = <span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(requireActivity()).get(OneViewModel.class);</span><br><span class="line">        <span class="comment">//界面切换数据就不在了所以将数据存在v-model中，视图创建时刷新一下</span></span><br><span class="line">        imageView.setRotation(mViewModel.rotationPosition);</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Use the ViewModel</span></span><br><span class="line">        <span class="comment">//为imageView做一个旋转的浮点动画，从0到0</span></span><br><span class="line">        <span class="type">ObjectAnimator</span> <span class="variable">objectAnimator</span> <span class="operator">=</span> ObjectAnimator.ofFloat(imageView,<span class="string">&quot;rotation&quot;</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        objectAnimator.setDuration(<span class="number">500</span>);<span class="comment">//动画时间500毫秒</span></span><br><span class="line">        imageView.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="comment">//如果当前并没有在进行动画，那么才执行</span></span><br><span class="line">                <span class="keyword">if</span> (!objectAnimator.isRunning())&#123;</span><br><span class="line">                    <span class="comment">//当前角度，到当前角度加100度</span></span><br><span class="line">                    objectAnimator.setFloatValues(imageView.getRotation(),imageView.getRotation() + <span class="number">100</span>);</span><br><span class="line">                    mViewModel.rotationPosition+=<span class="number">100</span>;</span><br><span class="line">                    objectAnimator.start();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>缩放</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container,</span></span><br><span class="line"><span class="params">                             <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        View view=inflater.inflate(R.layout.fragment_two, container, <span class="literal">false</span>);</span><br><span class="line">        imageView=view.findViewById(R.id.imageView);</span><br><span class="line">        <span class="keyword">return</span>  view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityCreated</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">        mViewModel = <span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(TwoViewModel.class);</span><br><span class="line">        imageView.setScaleX(mViewModel.scaleFactor);</span><br><span class="line">        imageView.setScaleY(mViewModel.scaleFactor);</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Use the ViewModel</span></span><br><span class="line">        <span class="type">ObjectAnimator</span> <span class="variable">objectAnimatorX</span> <span class="operator">=</span> ObjectAnimator.ofFloat(imageView,<span class="string">&quot;scaleX&quot;</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="type">ObjectAnimator</span> <span class="variable">objectAnimatorY</span> <span class="operator">=</span> ObjectAnimator.ofFloat(imageView,<span class="string">&quot;scaleY&quot;</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//TODO 可以将这两个放进一个组里</span></span><br><span class="line">        objectAnimatorX.setDuration(<span class="number">500</span>);</span><br><span class="line">        objectAnimatorY.setDuration(<span class="number">500</span>);</span><br><span class="line">        imageView.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!objectAnimatorX.isRunning())&#123;</span><br><span class="line">                    objectAnimatorX.setFloatValues(imageView.getScaleX()+<span class="number">0.1f</span>);</span><br><span class="line">                    objectAnimatorY.setFloatValues(imageView.getScaleY()+<span class="number">0.1f</span>);</span><br><span class="line">                    mViewModel.scaleFactor+=<span class="number">0.1</span>;</span><br><span class="line">                    objectAnimatorX.start();</span><br><span class="line">                    objectAnimatorY.start();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>移动</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container,</span></span><br><span class="line"><span class="params">                            <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       View view=inflater.inflate(R.layout.fragment_three, container, <span class="literal">false</span>);</span><br><span class="line">       imageView=view.findViewById(R.id.imageView);</span><br><span class="line">       <span class="keyword">return</span>  view;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">//进行了一个随机的左移右移</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityCreated</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">       mViewModel = <span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(ThreeViewModel.class);</span><br><span class="line">       imageView.setX(imageView.getX()+mViewModel.dx);</span><br><span class="line">       <span class="comment">// <span class="doctag">TODO:</span> Use the ViewModel</span></span><br><span class="line">       <span class="type">ObjectAnimator</span> <span class="variable">objectAnimator</span> <span class="operator">=</span>ObjectAnimator.ofFloat(imageView,<span class="string">&quot;x&quot;</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">       objectAnimator.setDuration(<span class="number">500</span>);</span><br><span class="line">       imageView.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">               <span class="keyword">if</span>(!objectAnimator.isRunning())&#123;</span><br><span class="line">                   <span class="type">float</span> <span class="variable">dx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextBoolean()?<span class="number">100</span>:-<span class="number">100</span>;</span><br><span class="line">                   objectAnimator.setFloatValues(imageView.getX(),imageView.getX()+dx);</span><br><span class="line">                   mViewModel.dx+=dx;</span><br><span class="line">                   objectAnimator.start();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h1 id="常见报错及解决方法"><a href="#常见报错及解决方法" class="headerlink" title="常见报错及解决方法"></a>常见报错及解决方法</h1><blockquote>
<p>hardedcoded text </p>
</blockquote>
<p>硬编码文本，原因是直接把值写在属性里了，而不是创建一个string来维护。</p>
<blockquote>
<p>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules kotlin-stdlib-1.8.10 </p>
</blockquote>
<p>解决方法：在模块build.gradle中添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">   ... ... ...</span><br><span class="line">   implementation(platform(<span class="string">&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;</span>))<span class="comment">//这一段代码</span></span><br><span class="line">   ... ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>insufficient text color contrast ratio</p>
</blockquote>
<h2 id="遇到的问题：MainActivity-java中配置NavController后程序闪退。"><a href="#遇到的问题：MainActivity-java中配置NavController后程序闪退。" class="headerlink" title="遇到的问题：MainActivity.java中配置NavController后程序闪退。"></a>遇到的问题：MainActivity.java中配置NavController后程序闪退。</h2><p>解决方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavHostFragment</span> <span class="variable">navHostFragment</span> <span class="operator">=</span> (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragmentContainerView);</span><br><span class="line">navController = navHostFragment.getNavController();</span><br></pre></td></tr></table></figure>



<h2 id="如果弹出键盘出现导致视图被压缩那么应该"><a href="#如果弹出键盘出现导致视图被压缩那么应该" class="headerlink" title="如果弹出键盘出现导致视图被压缩那么应该"></a>如果弹出键盘出现导致视图被压缩那么应该</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在manifests中的activity中添加如下代码</span></span><br><span class="line">android:windowSoftInputMode=<span class="string">&quot;adjustNothing&quot;</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="矢量图"><a href="#矢量图" class="headerlink" title="矢量图"></a>矢量图</h2><p>适合做界面上的图标，在放大时不会出现锯齿。</p>
<p>在res目录下new Vector Asset创建矢量图。 </p>
<h1 id="res"><a href="#res" class="headerlink" title="res"></a>res</h1><p><code>dimens.xml:</code>存储尺寸值通常用于定义布局的大小、间距、边距等。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dimen</span> <span class="attr">name</span>=<span class="string">&quot;TeamTextSize&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">dimen</span>&gt;</span></span><br><span class="line">&lt;/resources</span><br></pre></td></tr></table></figure>

<p><code>color.xml:</code>存储颜色</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>#FF000000<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;white&quot;</span>&gt;</span>#FFFFFFFF<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;red&quot;</span>&gt;</span>#FFEA1111<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="方法收集"><a href="#方法收集" class="headerlink" title="方法收集"></a>方法收集</h1><p><strong>Toast类</strong></p>
<h2 id="Toast-makeText（）"><a href="#Toast-makeText（）" class="headerlink" title="Toast.makeText（）"></a>Toast.makeText（）</h2><p>在屏幕上显示某种东西然后一段时间后消失</p>
<p><strong>参数1需要获取Context对象。在Activity中可以用this或者getApplicationContext，在Fragment中可以用getActivity</strong></p>
<p>Context通常由<code>Activity</code>、<code>Service</code>或<code>Application</code>等Android组件提供。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Toast.makeText(getApplicationContext(),<span class="string">&quot;输入错误&quot;</span>,Toast.LENGTH_LONG).show();</span><br></pre></td></tr></table></figure>

<p>参数2是要显示的内容，参数3是显示的时间</p>
<p>.show必须有，不然不会显示。</p>
<h2 id="context-getResources-getString-R-string-MY-DATA"><a href="#context-getResources-getString-R-string-MY-DATA" class="headerlink" title="context.getResources().getString(R.string.MY_DATA);"></a>context.getResources().getString(R.string.MY_DATA);</h2><p>作用：在Activity外部获取string.xml资源</p>
<p>如果实在Activity内部那么直接getString(R.string.MY_DATA)就可以获取。</p>
<h2 id="TextUtils-isEmpty"><a href="#TextUtils-isEmpty" class="headerlink" title="TextUtils.isEmpty()"></a>TextUtils.isEmpty()</h2><p>检查Text的内容是否为空。</p>
<h2 id="View-OnClickListener"><a href="#View-OnClickListener" class="headerlink" title="View.OnClickListener"></a>View.OnClickListener</h2><p>拿到对应视图的一个监听对象。</p>
<h2 id="view-getId"><a href="#view-getId" class="headerlink" title="view.getId()"></a>view.getId()</h2><p>拿到对应view的id</p>
<h2 id="getString"><a href="#getString" class="headerlink" title="getString"></a>getString</h2><p>在string.xml中拿到string的KEY</p>
<p>binding.textView9.setText(getString(R.string.input_indicator));</p>
<h1 id="屏幕方向旋转"><a href="#屏幕方向旋转" class="headerlink" title="屏幕方向旋转"></a>屏幕方向旋转</h1><p>在屏幕翻转时会摧毁活动，然后再创建活动，需要进行数据的保存和恢复。</p>
<h2 id="如何使屏幕旋转了应用内容不会跟着变化。"><a href="#如何使屏幕旋转了应用内容不会跟着变化。" class="headerlink" title="如何使屏幕旋转了应用内容不会跟着变化。"></a>如何使屏幕旋转了应用内容不会跟着变化。</h2><p>在<code>AndroidManifest.xmls</code>中的<application>中的<activity>下添加**android:screenOrientation&#x3D;”portrait”**屏幕始终为肖像模式(竖屏形态)</p>
<h2 id="为竖直跟横向两个模式做两种布局"><a href="#为竖直跟横向两个模式做两种布局" class="headerlink" title="为竖直跟横向两个模式做两种布局"></a>为竖直跟横向两个模式做两种布局</h2><p><strong>再画一个land.xml</strong>，在layout目录下</p>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231122014414774.png" alt="image-20231122014414774"></p>
<h2 id="Model-View-Controller"><a href="#Model-View-Controller" class="headerlink" title="Model-View-Controller"></a>Model-View-Controller</h2><p>Activity–&gt;Controller</p>
<p>View–&gt; layout</p>
<p>model–&gt;</p>
<h1 id="View-model"><a href="#View-model" class="headerlink" title="View-model"></a>View-model</h1><p><strong>属于jetpack包下的Architecture模块的一个类</strong></p>
<p>View-model就是将view界面中的数据给独立出来，对它进行单独的管理，使得Controller控制器(Activity)只需要专注于控制界面的逻辑本身，以及响应用户操作就可以了，而不需要去管理界面上复杂的数据。</p>
<p><strong>View-model可以管理屏幕上的数据，当活动被摧毁或者重新创建时数据不会丢失。</strong></p>
<p>可以配合同模块下的LiveData对数据进行监听。</p>
<p>ViewModel还有一个非常重要的特性。我们都知道，当手机发生横竖屏旋转的时候， Activity会被重新创建，同时存放在Activity中的数据也会丢失。而ViewModel的生命周期和 Activity不同，它可以保证在手机屏幕发生旋转的时候不会被重新创建，只有当Activity退出的 时候才会跟着Activity一起销毁。</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231124072442227.png" alt="image-20231124072442227" style="zoom:80%;" />

<p>示例：</p>
<p>创建一个类，需要继承ViewModel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyViewModel</span> <span class="keyword">extends</span> <span class="title class_">ViewModel</span> &#123;</span><br><span class="line">    <span class="comment">// 在此处添加需要存储和管理的数据,这里的数据</span></span><br><span class="line">    <span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>获取自定义ViewModel实例</strong></p>
<p>ViewModelProvider(&lt;你的Activity或Fragment实例&gt;).get(&lt;你的ViewModel&gt;.class.java)</p>
<p>这里获取到的是**自己自定的类(MyViewModel)**的实例。</p>
<p>this这个参数是需要获取一个Context</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MyViewModel viewmodel;</span><br><span class="line"><span class="comment">// 获取ViewModel实例,第一个参数是v-model的作用域</span></span><br><span class="line">        myViewModel= <span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(MyViewModel.class);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在OnCreate函数内拿回数据 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">textView.setText(String.valueOf(viewmodel.num));</span><br></pre></td></tr></table></figure>

<h2 id="状态保存-如何在系统杀死应用之后应用的数据还是能够得到保存"><a href="#状态保存-如何在系统杀死应用之后应用的数据还是能够得到保存" class="headerlink" title="状态保存-如何在系统杀死应用之后应用的数据还是能够得到保存"></a>状态保存-<strong>如何在系统杀死应用之后应用的数据还是能够得到保存</strong></h2><p>当应用在后台的时间过长时，应用可能会被无声杀死，甚至连destory函数都不会调用。</p>
<p>进入后台、屏幕翻转、语言切换这三个操作都不会使View-model保存的数据丢失，<strong>但是如果发生系统杀死后台进程这一个操作</strong>（可以在开发者模式中设置不允许有后台应用），那么View-model和活动也随之会被杀掉，然后重新创建一个View-model对象，之前的数据就会丢失。</p>
<p><strong>如何在系统杀死应用之后应用的数据还是能够得到保存</strong></p>
<p><strong>方法1</strong></p>
<p>​	<strong>onSaveInstanceState+v-model+liveData</strong></p>
<p>推荐<strong>方法2</strong></p>
<p><strong>SavedStateHandle</strong></p>
<p><strong>1.添加依赖</strong></p>
<blockquote>
<p>implementation (“androidx.lifecycle:lifecycle-viewmodel-savedstate:2.5.1”)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">var</span> <span class="variable">lifecycle_version</span> <span class="operator">=</span> <span class="string">&quot;2.5.1&quot;</span></span><br><span class="line">   <span class="comment">// ViewModel</span></span><br><span class="line">   implementation (<span class="string">&quot;androidx.lifecycle:lifecycle-viewmodel:$lifecycle_version&quot;</span>)</span><br><span class="line">   <span class="comment">// Saved state module for ViewModel</span></span><br><span class="line">   implementation (<span class="string">&quot;androidx.lifecycle:lifecycle-viewmodel-savedstate:$lifecycle_version&quot;</span>)</span><br><span class="line">   <span class="comment">// Annotation processor</span></span><br><span class="line">   annotationProcessor (<span class="string">&quot;androidx.lifecycle:lifecycle-compiler:$lifecycle_version&quot;</span>)</span><br></pre></td></tr></table></figure>



<p><strong>2.在v-model中添加构造函数</strong></p>
<p><code>SavedStateHandle:</code> 类似于MAP集合的键值对构造。这就是个LiveData,用来暂存数据，也可以监听数据的变化。</p>
<p>传递进来的<strong>SavedStateHandle handle</strong>不可能为空，所以不用进行判空</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">MyViewModel</span><span class="params">(SavedStateHandle handle)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.handle = handle;</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> MutableLiveData&lt;Integer&gt; <span class="title function_">getaTeamScore</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!handle.contains(<span class="string">&quot;KEY&quot;</span>))&#123;</span><br><span class="line">          handle.set(<span class="string">&quot;KEY&quot;</span>,<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>



<h2 id="数据永久保存"><a href="#数据永久保存" class="headerlink" title="数据永久保存"></a>数据永久保存</h2><p>虽然说有了以上的可以保存数据的方法，但是当按下返回键或者关机重启之后数据还是丢失。</p>
<p>如果想在这些情况下依然想把数据保存下来，那么久需要进行一个永久保存。</p>
<p>方法：<strong>SharedPreferces</strong></p>
<p>SharedPreferces是 Android 中用于存储小量持久化数据的一种机制。它提供了一种简单的键值对存储方式，用于在应用程序的不同组件之间共享数据，或者在应用程序的多次运行之间保持一些持久化的设置。</p>
<p><code>SharedPreferences</code> <strong>存储的数据是私有的</strong>，仅对当前应用程序可见。其他应用程序无法直接访问另一个应用程序的 </p>
<p><strong>示例：</strong></p>
<p><strong><code>getSharedPreferences(String name, int mode)</code>：</strong></p>
<ul>
<li><strong>参数：</strong> 接受两个参数，第一个参数是用于标识 <code>SharedPreferences</code> xml文件的名称，第二个参数是访问模式（通常为 <code>Context.MODE_PRIVATE</code>）。</li>
<li><strong>用途：</strong> 适用于多个组件（Activity、Service、Application等）需要共享相同的 <code>SharedPreferences</code> 文件时。可以在多个组件之间共享相同的数据，因为它指定了一个全局的文件名称。</li>
</ul>
<p><strong><code>getPreferences(int mode)</code>：</strong></p>
<ul>
<li><strong>参数：</strong> 只接受一个参数，即访问模式（通常为 <code>Context.MODE_PRIVATE</code>）。</li>
<li><strong>用途：</strong> 适用于在单个 <code>Activity</code> 中使用 <code>SharedPreferences</code>。它使用了默认的 <code>SharedPreferences</code> 文件名称，该名称基于调用 <code>getPreferences</code> 的 <code>Activity</code> 的类名。</li>
</ul>
<p>总体来说，两者的使用场景取决于你的需求。如果多个组件需要共享相同的 <code>SharedPreferences</code> 文件，使用 <code>getSharedPreferences</code> 并指定文件名称。如果只在单个 <code>Activity</code> 中使用，而不需要与其他组件共享数据，可以使用 <code>getPreferences</code>，它将基于调用的 <code>Activity</code> 类名自动生成一个默认的文件名。</p>
<p><strong>创建出这个对象等同于创建出了一个文件，通过这个方式创建出的对象是一个单例对象，所以一直都是一个文件</strong></p>
<hr>
<h3 id="getPreferences-int-mode"><a href="#getPreferences-int-mode" class="headerlink" title="getPreferences(int mode)"></a>getPreferences(int mode)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过getSharedPreferences获取实例</span></span><br><span class="line"><span class="type">SharedPreferences</span> <span class="variable">she</span> <span class="operator">=</span>getPreferences(Context.MODE_PRIVATE);<span class="comment">//获取实例</span></span><br><span class="line">        SharedPreferences.<span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span>she.edit();<span class="comment">//如果要对其尽心写的操作执行这段话</span></span><br><span class="line">        editor.putInt(<span class="string">&quot;num&quot;</span>,<span class="number">100</span>);<span class="comment">//在SharedPreferences文件中写入数据</span></span><br><span class="line">        editor.apply(); <span class="comment">//apply采用非同步的方式提交，commit采用同步的方式进行提交</span></span><br><span class="line">        <span class="type">int</span> x= she.getInt(<span class="string">&quot;num&quot;</span>,<span class="number">0</span>);<span class="comment">//取值，第二个参数是如果没有的话提供一个0</span></span><br></pre></td></tr></table></figure>

<p>然后就会在data.data.项目路径下多出一个目录<code>shared_prefs</code>里面有一个xml文件用于存储数据。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27; standalone=&#x27;yes&#x27; ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">&quot;num&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="getSharedPreferences-String-name-int-mode"><a href="#getSharedPreferences-String-name-int-mode" class="headerlink" title="getSharedPreferences(String name, int mode)"></a>getSharedPreferences(String name, int mode)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过getSharedPreferences获取实例</span></span><br><span class="line"><span class="type">SharedPreferences</span> <span class="variable">she</span> <span class="operator">=</span>getSharedPreferences(<span class="string">&quot;data&quot;</span>,Context.MODE_PRIVATE);</span><br><span class="line">        SharedPreferences.<span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span>she.edit();<span class="comment">//如果要对其尽心写的操作执行这段话</span></span><br><span class="line">        editor.putInt(<span class="string">&quot;num&quot;</span>,<span class="number">100</span>);<span class="comment">//在SharedPreferences文件中写入数据</span></span><br><span class="line">        editor.apply(); <span class="comment">//apply采用非同步的方式提交，commit采用同步的方式进行提交</span></span><br><span class="line">        <span class="type">int</span> x= she.getInt(<span class="string">&quot;num&quot;</span>,<span class="number">0</span>);<span class="comment">//取值，第二个参数是如果没有的话提供一个0</span></span><br></pre></td></tr></table></figure>

<p>然后就会在data.data.项目路径下多出一个目录<code>shared_prefs</code>里面有一个data.xml文件用于存储数据。</p>
<p>getSharedPreference继承与Context类下，Activity也是继承于Context的，所以才可以直接在Activity调用这个方法。</p>
<p><strong>在Activity外如何访问getSharedPreference？</strong></p>
<p>​	需要传递过去一个Context参数。</p>
<p><strong>演示</strong></p>
<p>1.Activity外部类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Data</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Data</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">SharedPreferences</span> <span class="variable">shp</span> <span class="operator">=</span> context.getSharedPreferences(<span class="string">&quot;data&quot;</span>,Context.MODE_PRIVATE);</span><br><span class="line">        SharedPreferences.<span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span>shp.edit();<span class="comment">//如果要对其尽心写的操作执行这段话</span></span><br><span class="line">        editor.putInt(<span class="string">&quot;num&quot;</span>,<span class="number">200</span>);<span class="comment">//在SharedPreferences文件中写入数据</span></span><br><span class="line">        editor.apply(); <span class="comment">//apply采用非同步的方式提交，commit采用同步的方式进行提交</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">load</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">SharedPreferences</span> <span class="variable">shp</span> <span class="operator">=</span> context.getSharedPreferences(<span class="string">&quot;data&quot;</span>,Context.MODE_PRIVATE);</span><br><span class="line">        <span class="type">int</span> x= shp.getInt(<span class="string">&quot;num&quot;</span>,<span class="number">0</span>);<span class="comment">//取值，第二个参数是如果没有的话提供一个0*/</span></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.Activity的Oncreate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">      <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">      setContentView(R.layout.activity_main);</span><br><span class="line">     <span class="type">Data</span> <span class="variable">data</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Data</span>(getApplicationContext());<span class="comment">//不能传递this,会有一个内存泄漏</span></span><br><span class="line">      data.number=<span class="number">1000</span>;</span><br><span class="line">      data.save();  <span class="comment">//存值</span></span><br><span class="line">      <span class="type">int</span> y= data.load();  <span class="comment">//取值</span></span><br></pre></td></tr></table></figure>

<h3 id="AndroidViewModel将v-model数据和SharedPreference进行关联完成持久化操作的完整示例"><a href="#AndroidViewModel将v-model数据和SharedPreference进行关联完成持久化操作的完整示例" class="headerlink" title="AndroidViewModel将v-model数据和SharedPreference进行关联完成持久化操作的完整示例"></a>AndroidViewModel将v-model数据和SharedPreference进行关联完成持久化操作的完整示例</h3><p>v-model中的SavedState去操作SharedPreference中的数据。</p>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231123012711205.png" alt="image-20231123012711205"></p>
<p><strong>ViewModel类</strong></p>
<p>handle有LiveData的功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//继承AndroidViewModel就可以直接获取Activity全局资源</span></span><br><span class="line"><span class="keyword">package</span> com.example.v_model_shp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Application;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.SharedPreferences;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.NonNull;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.AndroidViewModel;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.LiveData;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.SavedStateHandle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@noinspection</span> ALL*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewModel</span> <span class="keyword">extends</span> <span class="title class_">AndroidViewModel</span> &#123;</span><br><span class="line">    SavedStateHandle handle;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ViewModel</span><span class="params">(<span class="meta">@NonNull</span> Application application, SavedStateHandle handle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(application);</span><br><span class="line">        <span class="built_in">this</span>.handle = handle;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!handle.contains(<span class="string">&quot;key&quot;</span>)) &#123;</span><br><span class="line">            load();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> LiveData&lt;Integer&gt; <span class="title function_">getnumber</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> handle.getLiveData(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//从SharedPreference读取数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">load</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//因为继承了AndroidViewModel所以可以直接获取全局资源getApplication</span></span><br><span class="line">        <span class="comment">//通过调用 getApplication() 方法，你可以获取到当前应用程序的 Application 对象，从而访问应用程序级别的资源</span></span><br><span class="line">        <span class="comment">//getApplication是Context的一个子类</span></span><br><span class="line">        SharedPreferences shp=getApplication().getSharedPreferences(<span class="string">&quot;data&quot;</span>,Context.MODE_PRIVATE);</span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> shp.getInt(<span class="string">&quot;key&quot;</span>,<span class="number">0</span>);<span class="comment">//从SharedPreferences读取数据</span></span><br><span class="line">        handle.set(<span class="string">&quot;key&quot;</span>,x);   <span class="comment">//写入v-mod的handle中</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">      <span class="type">SharedPreferences</span> <span class="variable">shp</span> <span class="operator">=</span> getApplication().getSharedPreferences(<span class="string">&quot;data&quot;</span>, Context.MODE_PRIVATE);</span><br><span class="line">      SharedPreferences.<span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> shp.edit();</span><br><span class="line">      editor.putInt(<span class="string">&quot;key&quot;</span>, getnumber().getValue());</span><br><span class="line">      editor.apply();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">    handle.set(<span class="string">&quot;key&quot;</span>,getnumber().getValue()+x);</span><br><span class="line">    save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>以下两段代码操作的都是同一个数据结构LiveData</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">handle.getLiveData(&quot;key&quot;);</span><br><span class="line">handle.set(&quot;key&quot;,getnumber().getValue()+x);</span><br></pre></td></tr></table></figure>

<p>主活动类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.v_model_shp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.databinding.DataBindingUtil;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.SavedStateHandle;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.SavedStateViewModelFactory;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.v_model_shp.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    ViewModel viewModel;</span><br><span class="line">    ActivityMainBinding binding;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        binding= DataBindingUtil.setContentView(<span class="built_in">this</span>,R.layout.activity_main);</span><br><span class="line">        viewModel=<span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(ViewModel.class);</span><br><span class="line"></span><br><span class="line">        binding.setData(viewModel);</span><br><span class="line">       </span><br><span class="line">        binding.setLifecycleOwner(<span class="built_in">this</span>);  <span class="comment">//实现livedata的自我监听</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">&quot;data&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">&quot;com.example.v_model_shp.ViewModel&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;@&#123;String.valueOf(data.getnumber())&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;34sp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintVertical_bias</span>=<span class="string">&quot;0.116&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;44dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;352dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;+&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:onClick</span>=<span class="string">&quot;@&#123;()-&gt;data.add(1)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/button2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;44dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;352dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;-&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:onClick</span>=<span class="string">&quot;@&#123;()-&gt;data.add(-1)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<h1 id="LiveData"><a href="#LiveData" class="headerlink" title="LiveData"></a>LiveData</h1><p>在原始的ViewModel中，存储了数据当活动进行改变时我们还需要在控制层进行一个数据的恢复，但是使用LiveData之后，会对数据进行一个监听，动态的将数据在view上进行一个恢复，不用在控制层写数据逻辑。</p>
<blockquote>
<p>在数据更改时通知视图</p>
</blockquote>
<p><code>MutableLiveData&lt;Integer&gt;</code>：MutableLiveData是一个LiveData容器类。</p>
<p><code>setValue</code>：设置值</p>
<p><strong>LiveData：</strong> 是一种不可变的数据持有类。一旦设置了数据值，就不能再更改。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 尝试在外部如（Activity）修改 LiveData（这是不合适的）</span></span><br><span class="line">    <span class="comment">// userViewModel.getUserLiveData().setValue(new User(&quot;New User&quot;)); // 这行代码会导致编译错误</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserViewModel</span> <span class="keyword">extends</span> <span class="title class_">ViewModel</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> MutableLiveData&lt;User&gt; userLiveData = <span class="keyword">new</span> <span class="title class_">MutableLiveData</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对外提供的 LiveData，但是外部只能观察，不能直接修改</span></span><br><span class="line">    <span class="keyword">public</span> LiveData&lt;User&gt; <span class="title function_">getUserLiveData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userLiveData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在 ViewModel 内部设置数据的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// 在内部调用 setValue，以触发 LiveData 的通知</span></span><br><span class="line">        userLiveData.setValue(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p><strong>MutableLiveData：</strong> 是 <code>LiveData</code> 的子类，它具有可变性。意味着你可以更改 </p>
<p>如果使用 MutableLiveData<Integer>封装整数值，那么每个 MutableLiveData<Integer>对象只能封装一个整数值。</p>
<p><code>MutableLiveData</code> 是用于持有单一数据项的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">observe(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">Observer</span>&lt;List&lt;Word&gt;&gt;()  <span class="comment">//这个this是Activity，是Activity观察LiveData</span></span><br></pre></td></tr></table></figure>

<p><strong>创建一个ViewModel，里面维护一个LiveData</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyViewModelWithLiveData</span> <span class="keyword">extends</span> <span class="title class_">ViewModel</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> MutableLiveData&lt;Integer&gt; LikedNumber;</span><br><span class="line">	<span class="comment">//在xml文件中data.getNumber()可以直接获取到封装的值，但在java对象中需要data.getNumber().getValue()才行</span></span><br><span class="line">    <span class="keyword">public</span> MutableLiveData&lt;Integer&gt; <span class="title function_">getLikedNumber</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (LikedNumber==<span class="literal">null</span>)&#123;</span><br><span class="line">            LikedNumber =<span class="keyword">new</span> <span class="title class_">MutableLiveData</span>&lt;&gt;();</span><br><span class="line">            LikedNumber.setValue(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> LikedNumber;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLikedNumber</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">        LikedNumber.setValue(LikedNumber.getValue()+n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>给<strong>ViewModel</strong>中的<strong>LiveData</strong>(MutableLiveData)对象添加一个观察者observe，第一个参数是观察谁，观察的是自己this,第二个参数是一个函数式接口，当数据变化时会执行的一个函数。</p>
<p> <code>onChanged</code>:当代码改变时就会执行这个函数</p>
<p>public void onChanged(Integer integer) <strong>integer</strong>就是当前<strong>LiveData</strong>对象所存储的数据。</p>
<p><code>myViewModelWithLiveData</code> &#x3D;new ViewModelProvider(this).get(MyViewModelWithLiveData.class);通过这个方式创建的对象知道什么时候创建什么时候摧毁。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  myViewModelWithLiveData=<span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(MyViewModelWithLiveData.class);</span><br><span class="line"><span class="comment">//对数据进行一个监控，当数据改变时对它进行一个刷新，刷新到view上       </span></span><br><span class="line">myViewModelWithLiveData.getLikedNumber().observe(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">Observer</span>&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChanged</span><span class="params">(Integer integer)</span> &#123;</span><br><span class="line">                textView.setText(String.valueOf(integer));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>



<h1 id="Data-Binding数据绑定"><a href="#Data-Binding数据绑定" class="headerlink" title="Data Binding数据绑定"></a>Data Binding数据绑定</h1><h2 id="将可观察数据绑定到界面元素-view–-Binding"><a href="#将可观察数据绑定到界面元素-view–-Binding" class="headerlink" title="将可观察数据绑定到界面元素.  view–&gt;Binding"></a>将可观察数据绑定到界面元素.  view–&gt;Binding</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//就是将这些控件给挪个位</span></span><br><span class="line">TextView textView;</span><br><span class="line">ImageButton imageButton,imageButton2;</span><br></pre></td></tr></table></figure>

<p><strong>1.要将应用配置为使用数据绑定，请在应用模块的 <code>build.gradle</code> 文件中添加 <code>dataBinding</code> 元素，如以下示例所示：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">        ...</span><br><span class="line">     buildFeatures &#123;</span><br><span class="line">        dataBinding =true</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">dependencies &#123;</span><br><span class="line">   ... ... ...</span><br><span class="line">   implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))//这一段代码</span><br><span class="line">   ... ... ...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>2.<strong>添加完成之后回到main.xml文件</strong></p>
<p>​	多出一个layout和data标签。</p>
<p>​	</p>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231122171233312.png" alt="image-20231122171233312"></p>
<p><strong>3.在主视图中创建</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//然后就会自动创建出一个倒着的xml文件名+Binding的对象(驼峰命名)。</span></span><br><span class="line">ActivityMainBinding activityMainBinding;</span><br></pre></td></tr></table></figure>

<p><strong>4.主视图中的这一段代码就可以不需要了</strong></p>
<p>​	<strong>这行代码的作用是将指定的布局文件与当前的 <code>Activity</code> 绑定，显示在屏幕上。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//  setContentView(R.layout.activity_main);</span><br></pre></td></tr></table></figure>

<p><strong>5.替换为</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在Create函数中</span></span><br><span class="line">activityMainBinding= DataBindingUtil.setContentView(<span class="built_in">this</span>,R.layout.activity_main);</span><br></pre></td></tr></table></figure>

<p>​	创建了这个ActivityMainBinding对象。</p>
<p><strong>在这之后所有xml里面的例如Button,TextView都会成为这个对象的成员。</strong></p>
<p>可以通过<code>activityMainBinding.TextView</code>来进行访问，就不需要进行<code>TextView textView;</code></p>
<p><code>textView=findViewById(R.id.textView);</code>这一步了。</p>
<h2 id="Binding–-view"><a href="#Binding–-view" class="headerlink" title="Binding–&gt;view"></a>Binding–&gt;view</h2><p>利用xml文件中的Data标签</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;data&gt;</span><br><span class="line">       &lt;variable</span><br><span class="line">           name=<span class="string">&quot;data&quot;</span></span><br><span class="line">           type=<span class="string">&quot;com.example.livedata.MyViewModelWithLiveData&quot;</span> /&gt;</span><br><span class="line">   &lt;/data&gt;</span><br></pre></td></tr></table></figure>

<p>做完上一步操作之后呢就可以在xml文件中直接将数据写入view</p>
<p><strong>注意：</strong>必须有对应的get方法，不然拿不到对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView&gt;  </span><br><span class="line">android:text=<span class="string">&quot;Hello World!&quot;</span></span><br><span class="line">  <span class="comment">//改为</span></span><br><span class="line"> android:text=<span class="string">&quot;@&#123;String.valueOf(data.likedNumber)&#125;&quot;</span> <span class="comment">//用到了get方法</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">//改为   </span></span><br><span class="line"> &lt;ImageButton</span><br><span class="line"> android:onClick=<span class="string">&quot;@&#123;()-&gt;data.addLikedNumber(1)&#125;&quot;</span>    </span><br><span class="line"></span><br><span class="line">   <span class="comment">//likedNumber就是MutableLiveData</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyViewModelWithLiveData</span> <span class="keyword">extends</span> <span class="title class_">ViewModel</span> &#123;</span><br><span class="line">   <span class="keyword">private</span> MutableLiveData&lt;Integer&gt; LikedNumber;</span><br></pre></td></tr></table></figure>

<p>在主Activity中就可以做出改变</p>
<p>1.添加这一段代码,括号里的参数是viewModel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">activityMainBinding.setData(myViewModelWithLiveData);</span><br><span class="line">activityMainBinding.setLifecycleOwner(<span class="built_in">this</span>);  <span class="comment">//实现livedata的自我监听</span></span><br></pre></td></tr></table></figure>

<p>2.主活动中改变</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">activityMainBinding.imageButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                myViewModelWithLiveData.addLikedNumber(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="comment">//可替换为</span></span><br><span class="line">android:onClick=<span class="string">&quot;@&#123;()-&gt;data.addLikedNumber(1)&#125;&quot;</span></span><br></pre></td></tr></table></figure>



<p>以下两段代码等价</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">myViewModelWithLiveData.getLikedNumber().observe(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">Observer</span>&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChanged</span><span class="params">(Integer integer)</span> &#123;</span><br><span class="line">                activityMainBinding.textView.setText(String.valueOf(integer));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:onClick=<span class="string">&quot;@&#123;() -&gt; data.addLikedNumber(1)&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="精简后的主活动"><a href="#精简后的主活动" class="headerlink" title="精简后的主活动"></a><strong>精简后的主活动</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    MyViewModel myViewModel;</span><br><span class="line">    ActivityMainBinding activityMainBinding;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="comment">//主活动中这么配置</span></span><br><span class="line">        activityMainBinding= DataBindingUtil.setContentView(<span class="built_in">this</span>,R.layout.activity_main);</span><br><span class="line">        myViewModel=<span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(MyViewModel.class);<span class="comment">//只要是构造函数都会被调用</span></span><br><span class="line">        activityMainBinding.setData(myViewModel);</span><br><span class="line">        <span class="comment">//如果是在activity中直接this,如果实在Fragments的话需要getActivity()</span></span><br><span class="line">        <span class="comment">//getActivity() 返回的是 Fragment 所关联的 Activity 的实例。</span></span><br><span class="line">        activityMainBinding.setLifecycleOwner(<span class="built_in">this</span>);  <span class="comment">//实现livedata的自我监听</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Navigation导航"><a href="#Navigation导航" class="headerlink" title="Navigation导航"></a>Navigation导航</h1><p>使得页面之间的切换变得更加的容易。</p>
<p><code>NavHost:</code> 存放页面的容器，也是一个控制器，Host相当于是一个栈，然后里面存放Fragment</p>
<p><code>Fragment:</code>用来实现屏幕上的一小块内容，本意是将一个大屏幕分割为很多个部分（Fragment），一个活动可以有多个Fragment。</p>
<p>​	一个java类，一个xml</p>
<p><code>NavController:</code>控制导航的逻辑，控制按下某一个按键就进行一个页面的切换</p>
<p><code>NavGraph:</code> 设置导航的路径（逻辑），由哪里切换到哪里，控制的是导航图（<code>NavGraph</code>）中的导航操作</p>
<p>​	属于res文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//若创建NavGraph失败则添加两个依赖</span></span><br><span class="line">implementation (<span class="string">&quot;androidx.navigation:navigation-fragment-ktx:2.3.5&quot;</span>)</span><br><span class="line">   implementation (<span class="string">&quot;androidx.navigation:navigation-ui-ktx:2.3.5&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>在主活动xml中拖动NavHostFragment</strong></p>
<h2 id="在主活动中使用导航并在左上角添加返回箭头"><a href="#在主活动中使用导航并在左上角添加返回箭头" class="headerlink" title="在主活动中使用导航并在左上角添加返回箭头"></a>在主活动中使用导航并在左上角添加返回箭头</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//找Fragment的View</span></span><br><span class="line"><span class="type">NavHostFragment</span> <span class="variable">navHostFragment</span> <span class="operator">=</span> (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragmentContainerView);</span><br><span class="line">navController = navHostFragment.getNavController(); </span><br></pre></td></tr></table></figure>

<p>创建一个ActionBar也就是左上角的导航条</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NavigationUI.setupActionBarWithNavController(<span class="built_in">this</span>,navController); </span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重写函数</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onSupportNavigateUp</span><span class="params">()</span> &#123;</span><br><span class="line">        navController.navigateUp(); <span class="comment">//回到上一个导航页面</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onSupportNavigateUp();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p><strong>在HomeFragment.java中添加以下代码完成点击按钮页面跳转</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">       Button button;</span><br><span class="line">       button = getView().findViewById(R.id.button);</span><br><span class="line">       button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">               <span class="type">NavController</span> <span class="variable">controller</span> <span class="operator">=</span> Navigation.findNavController(view);</span><br><span class="line">               <span class="comment">//完成Home--&gt;Detail</span></span><br><span class="line">               controller.navigate(R.id.action_homeFragment_to_detailFragment);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>getView()</code> 方法用于获取与 <code>Fragment</code> 相关联的视图。</li>
</ul>
<blockquote>
<p> NavController controller &#x3D; Navigation.findNavController(view);</p>
</blockquote>
<ol>
<li><strong><code>Navigation</code> 类：</strong> 是 Navigation 组件的一个工具类，提供了许多用于导航的实用方法。</li>
<li><strong><code>findNavController</code> 方法：</strong> 这个方法是用来查找与给定的 <code>View</code> 相关联的 <code>NavController</code> 对象。<code>NavController</code> 负责管理应用程序中的导航，它知道应用程序中的所有导航图，可以导航到这些图中的目的地。</li>
<li><strong><code>view</code> 参数：</strong> 这是传递给 <code>findNavController</code> 方法的 <code>View</code> 对象，表示当前的视图。通常情况下，这个 <code>view</code> 参数是在 <code>Fragment</code> 或 <code>Activity</code> 中的生命周期方法中调用的。</li>
<li><strong><code>NavController controller</code>：</strong> 这是返回的 <code>NavController</code> 对象，它表示当前视图的导航控制器。通过这个控制器，你可以执行导航操作，比如跳转到其他目的地。</li>
</ol>
<p><strong>在DetailFragment.java中添加以下代码完成点击按钮页面跳转</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">       Button button;</span><br><span class="line">       button = getView().(R.id.button2);</span><br><span class="line">       button.setOnClickListener(view1 -&gt; &#123;</span><br><span class="line">           <span class="comment">//找到button所归属的Controller</span></span><br><span class="line">           <span class="type">NavController</span> <span class="variable">controller</span> <span class="operator">=</span> Navigation.findNavController(view1);</span><br><span class="line">           <span class="comment">//完成Home--&gt;Detail</span></span><br><span class="line">           controller.navigate(R.id.action_detailFragment_to_homeFragment);</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h2 id="导航中数据的传递"><a href="#导航中数据的传递" class="headerlink" title="导航中数据的传递"></a>导航中数据的传递</h2><p>1.新建两个fragment</p>
<p>2.进入对应的xml文件修改布局</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//修改为</span><br><span class="line">androidx.constraintlayout.widget.ConstraintLayout </span><br></pre></td></tr></table></figure>

<p>3.在res目录下新建nav.xml资源，type为Navigation,并添加依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implementation (<span class="string">&quot;androidx.navigation:navigation-fragment-ktx:2.3.5&quot;</span>)</span><br><span class="line">implementation (<span class="string">&quot;androidx.navigation:navigation-ui-ktx:2.3.5&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>4.选中nav.xml，点击手机+号添加对应的页面。添加完成之后带有房子界面的就是首界面。</p>
<p>5.进行导航的连线（action）</p>
<p>6.切换到主Activity.xml,<strong>在主Activity.xml中的Contailner中拖动NavHostFragment</strong>到页面上去，然后选择需要控制的nav.xml,并且做好约束连线。</p>
<p>7.为按钮进行一个时间绑定，进行导航跳转</p>
<p>8.在对应的java文件中编写函数，这里是在a.java中，从a跳转到b</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">       Button button;</span><br><span class="line">       button = getView().findViewById(R.id.button);</span><br><span class="line">       button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">               <span class="comment">//获取本视图的controller</span></span><br><span class="line">               <span class="type">NavController</span> <span class="variable">controller</span> <span class="operator">=</span> Navigation.findNavController(view);</span><br><span class="line">               <span class="comment">//完成Home--&gt;Detail,可以传递action，也可以传递需要跳转的fragment.xml</span></span><br><span class="line">               controller.navigate(R.id.action_homeFragment_to_detailFragment2);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>9.进行静态数据传递。<strong>b的Fragment-&gt;b的view</strong></p>
<p> 可以在nav.xml中找到对应的Fragment中找到Arguments属性添加一些参数</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231123183133381.png" alt="image-20231123183133381" style="zoom:50%;" />

<p><strong>在b中设置了一个key为name值为jack的参数。</strong></p>
<p>然后在b.java中获取参数并传递到视图上。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">      <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">      <span class="comment">//获取存入的参数</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span>getArguments().getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">      <span class="type">TextView</span> <span class="variable">textView</span> <span class="operator">=</span> getView().findViewById(R.id.textView);</span><br><span class="line">      textView.setText(s);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<p><strong>注意事项</strong></p>
<p>在点击这条线之后，可以覆盖掉之前的值为jack的值。但是呢，必须是下面的代码中传递的是action才生效，因为我们是点击了Action这条线设置的参数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//完成Home--&gt;Detail,可以传递action，也可以传递需要跳转的fragment.xml</span></span><br><span class="line">              controller.navigate(R.id.action_homeFragment_to_detailFragment2);</span><br></pre></td></tr></table></figure>



<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231123192530953.png" alt="image-20231123192530953" style="zoom:50%;" />

<p>10.进行动态的数据传递a–&gt;b。</p>
<p>从a中的输入框输入数据，然后将数据给传递出去，用Bundle来临时存储这个数据。a中的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">        Button button;</span><br><span class="line">        button = getView().findViewById(R.id.button);</span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">EditText</span> <span class="variable">editText</span> <span class="operator">=</span> getView().findViewById(R.id.editTextText);</span><br><span class="line">                <span class="comment">//editText.getText()的到的不是String,是另外一个对象，需要转一下</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span>editText.getText().toString();</span><br><span class="line">                <span class="comment">//提交前进行检查，是否有输入名字</span></span><br><span class="line">                <span class="keyword">if</span> (TextUtils.isEmpty(s))&#123;</span><br><span class="line">                    Toast.makeText(getActivity(),<span class="string">&quot;请输入名字&quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">Bundle</span> <span class="variable">bundle</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Bundle</span>();</span><br><span class="line">                bundle.putString(<span class="string">&quot;name&quot;</span>,s);</span><br><span class="line">                <span class="comment">//获取本视图的controller</span></span><br><span class="line">                <span class="type">NavController</span> <span class="variable">controller</span> <span class="operator">=</span> Navigation.findNavController(view);</span><br><span class="line">                <span class="comment">//完成Home--&gt;Detail,可以传递action，也可以传递需要跳转的fragment.xml</span></span><br><span class="line">                <span class="comment">//将bundle作为第二参数传递进去，在导航的目的地处就可以通过getArguments()获取这个bundle</span></span><br><span class="line">                controller.navigate(R.id.action_homeFragment_to_detailFragment2,bundle);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>11.b中获取参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">        <span class="comment">//获取存入的参数</span></span><br><span class="line">        <span class="type">TextView</span> <span class="variable">textView</span> <span class="operator">=</span> getView().findViewById(R.id.textView);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> getArguments().getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        textView.setText(name);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>12.完成数据传递。</p>
<h2 id="tween-animation-关键帧动画"><a href="#tween-animation-关键帧动画" class="headerlink" title="tween animation 关键帧动画"></a>tween animation 关键帧动画</h2><p><strong>1.创建一个资源</strong></p>
<p>在res中创建一个类型为animation的xml文件。</p>
<p><code>rotate:</code>旋转。 <code>scale:</code>缩放 。<code>translate:</code>移动 。 <code>alpha:</code>透明度</p>
<p><strong>2.在xml文件中的set标签中写。</strong></p>
<p>从屏幕左边完全看不见的位置-100%开始到0%正中间，时间为300毫秒，用时间控制速度</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">&quot;-100%&quot;</span> <span class="attr">x轴起始位置</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">&quot;0%&quot;</span>      <span class="attr">x轴末尾位置</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span> = <span class="string">&quot;300&quot;</span>&gt;</span>  时间</span><br><span class="line">    <span class="tag">&lt;/<span class="name">translate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>3.回到nav.xml，点击action</strong></p>
<p>设置enterAnim属性为刚才创建的animation.xml文件，enter就是时候a-&gt;b的动画中,b是以什么样的方式展现的。exit就是a-&gt;b的动画中，a是以什么样的方式离开的。</p>
<p><strong>大功告成，这样子在切换导航时，被切换的视图会从左边滑动过来，滑倒中间就停止。</strong></p>
<h2 id="更好的数据传递方式v-mod-nav-Fragment"><a href="#更好的数据传递方式v-mod-nav-Fragment" class="headerlink" title="更好的数据传递方式v-mod-nav-Fragment"></a>更好的数据传递方式v-mod-nav-Fragment</h2><p>Acivity重建时，所管理的Fragment也会重建。</p>
<p>将数据存到viewmodel中进行管理。</p>
<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231123205619860.png" alt="image-20231123205619860" style="zoom:50%;" />

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">创建 Fragment 时调用----onCreateView</span></span><br><span class="line"><span class="comment">在 onCreateView 之后被调用---onViewCreated</span></span><br><span class="line"><span class="comment">onCreate 主要用于非视图相关的初始化，而 onCreateView 主要用于创建和初始化 Fragment 的用户界面。</span></span><br><span class="line"><span class="comment">这两个方法的执行时机也不同，onCreate 在 Fragment 创建时调用，而 onCreateView 在需要绘制用户界面时调用。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>







<p><strong>1.创建两个Fragments。a和b</strong></p>
<p><strong>2.创建一个ViewModel</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyViewModel</span> <span class="keyword">extends</span> <span class="title class_">ViewModel</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> MutableLiveData&lt;Integer&gt; number;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> MutableLiveData&lt;Integer&gt; <span class="title function_">getNumber</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (number==<span class="literal">null</span>)&#123;</span><br><span class="line">            number=<span class="keyword">new</span> <span class="title class_">MutableLiveData</span>&lt;&gt;();</span><br><span class="line">            number.setValue(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">        number.setValue(number.getValue()+x);</span><br><span class="line">        <span class="keyword">if</span> (number.getValue()&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            number.setValue(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在a.xml中</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;data&gt;</span><br><span class="line">       &lt;variable</span><br><span class="line">           name=<span class="string">&quot;data&quot;</span></span><br><span class="line">           type=<span class="string">&quot;com.example.nav_v_model.MyViewModel&quot;</span> /&gt;</span><br><span class="line">   &lt;/data&gt;</span><br><span class="line"> &lt;TextView    </span><br><span class="line">android:text=<span class="string">&quot;@&#123;String.valueOf(data.getNumber())&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>4.在a.java中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> &#123;</span><br><span class="line">     MyViewModel myViewModel;</span><br><span class="line">     myViewModel=<span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(getActivity()).get(MyViewModel.class);</span><br><span class="line">     <span class="comment">//在Fragments中写这一段</span></span><br><span class="line">     <span class="type">FragmentABinding</span> <span class="variable">binding</span> <span class="operator">=</span> DataBindingUtil.inflate(inflater, R.layout.fragment_a, container, <span class="literal">false</span>);</span><br><span class="line">     binding.setData(myViewModel);</span><br><span class="line">     <span class="comment">//如果是在activity中直接this,如果实在Fragments的话需要getActivity()</span></span><br><span class="line">     <span class="comment">//getActivity() 返回的是 Fragment 所关联的 Activity 的实例。</span></span><br><span class="line">     binding.setLifecycleOwner(getActivity());</span><br><span class="line"></span><br><span class="line">     binding.button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">         <span class="meta">@Override</span></span><br><span class="line">         <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">             <span class="comment">//view指当前视图的实例Fragments</span></span><br><span class="line">             <span class="type">NavController</span> <span class="variable">controller</span> <span class="operator">=</span> Navigation.findNavController(view);</span><br><span class="line">             controller.navigate(R.id.action_aFragment_to_bFragment);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;);</span><br><span class="line">     <span class="comment">//当进入这个页面时，将v-mod中的数字先写入进来</span></span><br><span class="line">     binding.seekBar.setProgress(myViewModel.getNumber().getValue());</span><br><span class="line">     binding.seekBar.setOnSeekBarChangeListener(<span class="keyword">new</span> <span class="title class_">SeekBar</span>.OnSeekBarChangeListener() &#123;</span><br><span class="line">         <span class="meta">@Override</span></span><br><span class="line">         <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onProgressChanged</span><span class="params">(SeekBar seekBar, <span class="type">int</span> i, <span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">             <span class="comment">//滑动时将i的值写入进去</span></span><br><span class="line">            myViewModel.getNumber().setValue(i);</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="meta">@Override</span></span><br><span class="line">         <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStartTrackingTouch</span><span class="params">(SeekBar seekBar)</span> &#123;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="meta">@Override</span></span><br><span class="line">         <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStopTrackingTouch</span><span class="params">(SeekBar seekBar)</span> &#123;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;);</span><br><span class="line">     <span class="comment">//返回binding的根节点，view类型的。</span></span><br><span class="line">     <span class="keyword">return</span> binding.getRoot();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>5.b.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">TextView</span>         </span></span><br><span class="line"><span class="tag"><span class="attr">android:text</span>=<span class="string">&quot;@&#123;String.valueOf(data.getNumber())&#125;&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:onClick</span>=<span class="string">&quot;@&#123;()-&gt;data.add(-1)&#125;&quot;</span></span></span><br></pre></td></tr></table></figure>



<h1 id="lifeCycles"><a href="#lifeCycles" class="headerlink" title="lifeCycles"></a>lifeCycles</h1><p>用来观察Activity的生命周期并对此做出一些动作。</p>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231125001257201.png" alt="image-20231125001257201"></p>
<p>1.继承implements LifecycleEventObserver并在onStateChanged实现功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyChronometer</span> <span class="keyword">extends</span> <span class="title class_">Chronometer</span> <span class="keyword">implements</span> <span class="title class_">LifecycleEventObserver</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> time;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyChronometer</span><span class="params">(Context context, AttributeSet attrs)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStateChanged</span><span class="params">(<span class="meta">@NonNull</span> LifecycleOwner source, <span class="meta">@NonNull</span> Lifecycle.Event event)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (event == Lifecycle.Event.ON_PAUSE) &#123;</span><br><span class="line">            <span class="comment">// 在活动暂停时执行的代码</span></span><br><span class="line">            time = SystemClock.elapsedRealtime() - getBase();</span><br><span class="line">            stop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (event==Lifecycle.Event.ON_RESUME)&#123;</span><br><span class="line">            setBase(SystemClock.elapsedRealtime()-time);</span><br><span class="line">            start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.Activity.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">        MyChronometer chronometer;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        chronometer= findViewById(R.id.meter);</span><br><span class="line">        <span class="comment">//这段代码是将 Chronometer 组件添加为当前活动的生命周期观察者（Observer）</span></span><br><span class="line">        getLifecycle().addObserver(chronometer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Room"><a href="#Room" class="headerlink" title="Room"></a>Room</h1><p>SQLite的抽象</p>
<p>不允许在主线程执行。</p>
<p><strong>View-Model–&gt;Repository–&gt;Database</strong></p>
<p><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231125011806104.png" alt="image-20231125011806104"></p>
<h2 id="Entity-Dao-Database例子"><a href="#Entity-Dao-Database例子" class="headerlink" title="Entity.Dao.Database例子"></a>Entity.Dao.Database例子</h2><p>1.添加依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">val</span> <span class="variable">room_version</span> <span class="operator">=</span> <span class="string">&quot;2.5.1&quot;</span></span><br><span class="line">	<span class="comment">//Room</span></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-runtime:$room_version&quot;</span>)</span><br><span class="line">    annotationProcessor(<span class="string">&quot;androidx.room:room-compiler:$room_version&quot;</span>)</span><br><span class="line">    <span class="comment">//lombok </span></span><br><span class="line">    implementation (<span class="string">&quot;org.projectlombok:lombok:1.18.22&quot;</span>)</span><br><span class="line">    annotationProcessor (<span class="string">&quot;org.projectlombok:lombok:1.18.22&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>有注释的为可选依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="type">val</span> <span class="variable">room_version</span> <span class="operator">=</span> <span class="string">&quot;2.5.0&quot;</span></span><br><span class="line"></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-runtime:$room_version&quot;</span>)</span><br><span class="line">    annotationProcessor(<span class="string">&quot;androidx.room:room-compiler:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// To use Kotlin annotation processing tool (kapt)</span></span><br><span class="line">    kapt(<span class="string">&quot;androidx.room:room-compiler:$room_version&quot;</span>)</span><br><span class="line">    <span class="comment">// To use Kotlin Symbol Processing (KSP)</span></span><br><span class="line">    ksp(<span class="string">&quot;androidx.room:room-compiler:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Kotlin Extensions and Coroutines support for Room</span></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-ktx:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - RxJava2 support for Room</span></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-rxjava2:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - RxJava3 support for Room</span></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-rxjava3:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Guava support for Room, including Optional and ListenableFuture</span></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-guava:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Test helpers</span></span><br><span class="line">    testImplementation(<span class="string">&quot;androidx.room:room-testing:$room_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Paging 3 Integration</span></span><br><span class="line">    implementation(<span class="string">&quot;androidx.room:room-paging:$room_version&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.Entity类</p>
<p>&#x2F;&#x2F;每个字段一定都需要getter和setter方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pojo</span> &#123;</span><br><span class="line">    <span class="meta">@PrimaryKey(autoGenerate = true)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="comment">//不写@ColumnInfo的话就自动以属性名作为字段名</span></span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;english_word&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String word;</span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;chinese_Meaning&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String chineseMeaning;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.Mapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WordDao</span> &#123;</span><br><span class="line">    <span class="meta">@Insert</span></span><br><span class="line">    <span class="keyword">void</span>  <span class="title function_">insertWords</span><span class="params">(Word...words)</span>; <span class="comment">//...代表多个参数</span></span><br><span class="line">    <span class="meta">@Update</span></span><br><span class="line">    <span class="comment">//根据主键修改一行数据</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Word...words)</span>;</span><br><span class="line">    <span class="comment">//根据主键删除一行数据 </span></span><br><span class="line">    <span class="meta">@Delete</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">DeteleWords</span><span class="params">(Word...words)</span>;</span><br><span class="line">    <span class="comment">//清空</span></span><br><span class="line">    <span class="meta">@Query(&quot;DELETE FROM WORD&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAllWords</span><span class="params">()</span>;</span><br><span class="line">    <span class="meta">@Query(&quot;SELECT * FROM WORD ORDER BY ID DESC&quot;)</span></span><br><span class="line">    List&lt;Word&gt; <span class="title function_">getAllWords</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4.DataBase</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每一次数据库发生变化版本都要跟着变</span></span><br><span class="line"><span class="comment">//如果将 exportSchema 设置为 true，则 Room 会在构建过程中生成包含数据库架构信息的 JSON 文件。</span></span><br><span class="line"><span class="meta">@Database(entities = &#123;Word.class&#125;,version = 1,exportSchema = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span>  <span class="title class_">WordDatabase</span> <span class="keyword">extends</span> <span class="title class_">RoomDatabase</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> WordDao <span class="title function_">getWordDao</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>5.MainActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WordDatabase wordDatabase;</span><br><span class="line">WordDao wordDao;</span><br><span class="line"><span class="comment">//创建一个数据库，第三个参数是存储在文件中的数据库名称</span></span><br><span class="line">       wordDatabase = Room.databaseBuilder(<span class="built_in">this</span>.getApplicationContext(),WordDatabase.class,<span class="string">&quot;WordDatabase&quot;</span>)</span><br><span class="line">               .allowMainThreadQueries()<span class="comment">//强制允许在主线程中使用</span></span><br><span class="line">               .build();</span><br><span class="line">       wordDao=wordDatabase.getWordDao();  <span class="comment">//获取dao,掌握其中方法</span></span><br></pre></td></tr></table></figure>



<h2 id="Async-Task-Repository-View-Model-LiveData例子"><a href="#Async-Task-Repository-View-Model-LiveData例子" class="headerlink" title="Async Task-Repository-View_Model-LiveData例子"></a>Async Task-Repository-View_Model-LiveData例子</h2><p><code>Repository:</code>对数据进行操作的方法放在这</p>
<p><strong>MainActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    LiveData&lt;List&lt;Word&gt;&gt; AllWordsLive;</span><br><span class="line">    WordDatabase wordDatabase;</span><br><span class="line">    WordDao wordDao;</span><br><span class="line">    Button insert, delete, deleteAll, update;</span><br><span class="line">    TextView textView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="type">MyViewModel</span> <span class="variable">myViewModel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ViewModelProvider</span>(<span class="built_in">this</span>).get(MyViewModel.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建一个数据库，第三个参数是存储的时候的数据库名称</span></span><br><span class="line">        wordDatabase = WordDatabase.getDatabase(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//LiveData</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//数据发生改变就改变textView的值</span></span><br><span class="line">        myViewModel.getAllWordLive().observe(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">Observer</span>&lt;List&lt;Word&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChanged</span><span class="params">(List&lt;Word&gt; words)</span> &#123;</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">text</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; words.size(); i++) &#123;</span><br><span class="line">                    <span class="type">Word</span> <span class="variable">word</span> <span class="operator">=</span> words.get(i);</span><br><span class="line">                    text.append(word.getId()).append(<span class="string">&quot;:&quot;</span>).append(word.getWord()).append(<span class="string">&quot;=&quot;</span>).append(word.getChineseMeaning()).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                textView.setText(text.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        textView = findViewById(R.id.textView2);</span><br><span class="line">        deleteAll = findViewById(R.id.deleteAll);</span><br><span class="line">        delete = findViewById(R.id.delete);</span><br><span class="line">        update = findViewById(R.id.update);</span><br><span class="line">        insert = findViewById(R.id.insert);</span><br><span class="line">        insert.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">Word</span> <span class="variable">word</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Word</span>(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;你好&quot;</span>);</span><br><span class="line">                <span class="type">Word</span> <span class="variable">word2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Word</span>(<span class="string">&quot;world&quot;</span>, <span class="string">&quot;世界&quot;</span>);</span><br><span class="line">                myViewModel.insertWords(word, word2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        deleteAll.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line"></span><br><span class="line">                myViewModel.deleteAll();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        update.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">Word</span> <span class="variable">word</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Word</span>(<span class="string">&quot;String&quot;</span>, <span class="string">&quot;字符串&quot;</span>);</span><br><span class="line">                word.setId(<span class="number">188</span>);</span><br><span class="line">                myViewModel.update();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        delete.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">Word</span> <span class="variable">word</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Word</span>(<span class="string">&quot;String&quot;</span>, <span class="string">&quot;字符串&quot;</span>);</span><br><span class="line">                word.setId(<span class="number">188</span>);</span><br><span class="line">                myViewModel.deleteWords();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MyViewModel.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyViewModel</span> <span class="keyword">extends</span> <span class="title class_">AndroidViewModel</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> WordDao wordDao;</span><br><span class="line">    <span class="keyword">private</span> WordRepository wordRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyViewModel</span><span class="params">(<span class="meta">@NonNull</span> Application application)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(application);</span><br><span class="line">        wordRepository = <span class="keyword">new</span> <span class="title class_">WordRepository</span>(application);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LiveData&lt;List&lt;Word&gt;&gt; <span class="title function_">getAllWordLive</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> wordRepository.getAllWordsLive();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insertWords</span><span class="params">(Word... words)</span> &#123;</span><br><span class="line">        wordRepository.insertWords(words);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Word... words)</span> &#123;</span><br><span class="line">        wordRepository.update(words);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteWords</span><span class="params">(Word... words)</span> &#123;</span><br><span class="line">        wordRepository.deleteWords(words);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">()</span> &#123;</span><br><span class="line">        wordRepository.deleteAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Word.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Word</span> &#123;</span><br><span class="line">    <span class="meta">@PrimaryKey(autoGenerate = true)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="comment">//不写@ColumnInfo的话就自动以属性名作为字段名</span></span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;english_word&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String word;</span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;chinese_Meaning&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String chineseMeaning;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Word</span><span class="params">( String word, String chineseMeaning)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.word = word;</span><br><span class="line">        <span class="built_in">this</span>.chineseMeaning = chineseMeaning;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getWord</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> word;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setWord</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.word = word;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getChineseMeaning</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> chineseMeaning;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChineseMeaning</span><span class="params">(String chineseMeaning)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.chineseMeaning = chineseMeaning;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>WordDao.interface</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WordDao</span> &#123;</span><br><span class="line">    <span class="meta">@Insert</span></span><br><span class="line">    <span class="keyword">void</span>  <span class="title function_">insertWords</span><span class="params">(Word...words)</span>; <span class="comment">//...代表多个参数</span></span><br><span class="line">    <span class="meta">@Update</span></span><br><span class="line">    <span class="comment">//根据ID修改一行数据</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Word...words)</span>;</span><br><span class="line">    <span class="meta">@Delete</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">DeteleWords</span><span class="params">(Word...words)</span>;</span><br><span class="line">    <span class="comment">//清空</span></span><br><span class="line">    <span class="meta">@Query(&quot;DELETE FROM WORD&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAllWords</span><span class="params">()</span>;</span><br><span class="line">    <span class="meta">@Query(&quot;SELECT * FROM WORD ORDER BY ID DESC&quot;)</span></span><br><span class="line">  <span class="comment">//  List&lt;Word&gt; getAllWords();</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * LiveData这个对象系统自动放到副线程去处理了，不用再建一个线程专门使用。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    LiveData&lt;List&lt;Word&gt;&gt; <span class="title function_">getAllWordsLive</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>WordDatabase.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每一次数据库发生变化版本都要跟着变</span></span><br><span class="line"><span class="comment">//如果将 exportSchema 设置为 true，则 Room 会在构建过程中生成包含数据库架构信息的 JSON 文件。</span></span><br><span class="line"><span class="meta">@Database(entities = &#123;Word.class&#125;,version = 1,exportSchema = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span>  <span class="title class_">WordDatabase</span> <span class="keyword">extends</span> <span class="title class_">RoomDatabase</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行懒汉式线程安全单例化，因为数据库的实例化是比较耗费资源的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> WordDatabase INSTANCE;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> WordDatabase <span class="title function_">getDatabase</span><span class="params">(Context context)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (INSTANCE==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 这里getApplicationContext()是为了配合View-Model继承Andriod-View-Model中的哪个Application</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            INSTANCE = Room.databaseBuilder(context.getApplicationContext(),WordDatabase.class,<span class="string">&quot;WordDataBase&quot;</span>)</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> WordDao <span class="title function_">getWordDao</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>WordRepository.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordRepository</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> LiveData&lt;List&lt;Word&gt;&gt; allWordsLive;</span><br><span class="line">    WordDao wordDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WordRepository</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="type">WordDatabase</span> <span class="variable">wordDatabase</span> <span class="operator">=</span> WordDatabase.getDatabase(context.getApplicationContext());</span><br><span class="line">        wordDao=wordDatabase.getWordDao();</span><br><span class="line">        allWordsLive=wordDao.getAllWordsLive();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LiveData&lt;List&lt;Word&gt;&gt; <span class="title function_">getAllWordsLive</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> allWordsLive;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Word:输入到异步任务的参数类型</span></span><br><span class="line"><span class="comment">     * Void: 报告进度</span></span><br><span class="line"><span class="comment">     * Void:报告结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InsertAsyncTask</span> <span class="keyword">extends</span> <span class="title class_">AsyncTask</span>&lt;Word, Void, Void&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> WordDao wordDao;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">InsertAsyncTask</span><span class="params">(WordDao wordDao)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.wordDao = wordDao;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> Void <span class="title function_">doInBackground</span><span class="params">(Word... words)</span> &#123;</span><br><span class="line">            wordDao.insertWords(words);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insertWords</span><span class="params">(Word...words)</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InsertAsyncTask</span>(wordDao).execute(words);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Word...words)</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">updateAsyncTask</span>(wordDao).execute(words);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteWords</span><span class="params">(Word...words)</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">deleteAsyncTask</span>(wordDao).execute(words);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">deleteAllAsyncTask</span>(wordDao).execute();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">updateAsyncTask</span> <span class="keyword">extends</span> <span class="title class_">AsyncTask</span>&lt;Word, Void, Void&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> WordDao wordDao;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">updateAsyncTask</span><span class="params">(WordDao wordDao)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.wordDao = wordDao;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> Void <span class="title function_">doInBackground</span><span class="params">(Word... words)</span> &#123;</span><br><span class="line">            wordDao.update(words);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">deleteAsyncTask</span> <span class="keyword">extends</span> <span class="title class_">AsyncTask</span>&lt;Word, Void, Void&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> WordDao wordDao;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">deleteAsyncTask</span><span class="params">(WordDao wordDao)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.wordDao = wordDao;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> Void <span class="title function_">doInBackground</span><span class="params">(Word... words)</span> &#123;</span><br><span class="line">            wordDao.DeteleWords(words);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">deleteAllAsyncTask</span> <span class="keyword">extends</span> <span class="title class_">AsyncTask</span>&lt;Void, Void, Void&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> WordDao wordDao;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">deleteAllAsyncTask</span><span class="params">(WordDao wordDao)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.wordDao = wordDao;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> Void <span class="title function_">doInBackground</span><span class="params">(Void... voids)</span> &#123;</span><br><span class="line">            wordDao.deleteAllWords();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="RecyclerView呈现列表数据"><a href="#RecyclerView呈现列表数据" class="headerlink" title="RecyclerView呈现列表数据"></a>RecyclerView呈现列表数据</h2><h2 id="数据库的版本管理"><a href="#数据库的版本管理" class="headerlink" title="数据库的版本管理"></a>数据库的版本管理</h2><p>每添加或者删除一次数据库字段，就需要将数据库版本进行更新。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Word</span> &#123;</span><br><span class="line">    <span class="meta">@PrimaryKey(autoGenerate = true)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="comment">//不写@ColumnInfo的话就自动以属性名作为字段名</span></span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;english_word&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String word;</span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;chinese_Meaning&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String chineseMeaning;</span><br><span class="line">    <span class="comment">//添加的字段</span></span><br><span class="line">    <span class="meta">@ColumnInfo(name=&quot;bar_data&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> bar;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBar</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bar;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBar</span><span class="params">(<span class="type">boolean</span> bar)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bar = bar;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>版本更新 1–&gt;2，添加了一个字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每一次数据库发生变化版本都要跟着变</span></span><br><span class="line"><span class="comment">//如果将 exportSchema 设置为 true，则 Room 会在构建过程中生成包含数据库架构信息的 JSON 文件。</span></span><br><span class="line"><span class="meta">@Database(entities = &#123;Word.class&#125;,version = 2,exportSchema = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span>  <span class="title class_">WordDatabase</span> <span class="keyword">extends</span> <span class="title class_">RoomDatabase</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行懒汉式线程安全单例化，因为数据库的实例化是比较耗费资源的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> WordDatabase INSTANCE;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> WordDatabase <span class="title function_">getDatabase</span><span class="params">(Context context)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (INSTANCE==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 这里getApplicationContext()是为了配合View-Model继承Andriod-View-Model中的哪个Application</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            INSTANCE = Room.databaseBuilder(context.getApplicationContext(),WordDatabase.class,<span class="string">&quot;WordDataBase&quot;</span>)</span><br><span class="line">                    .addMigrations(MIGRATION_1_2)<span class="comment">//保留原有数据进行版本更新</span></span><br><span class="line">                	<span class="comment">//不保留原本的数据进行版本更新fallbackToDestructiveMigration(),就不用写Migration了</span></span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> WordDao <span class="title function_">getWordDao</span><span class="params">()</span>;、</span><br><span class="line">     <span class="comment">//构建一个版本常量，从版本1-2</span></span><br><span class="line">     <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Migration</span> <span class="variable">MIGRATION_1_2</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Migration</span>(<span class="number">1</span>,<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">migrate</span><span class="params">(<span class="meta">@NonNull</span> SupportSQLiteDatabase database)</span> &#123;</span><br><span class="line">            <span class="comment">//更新word表添加bar_data字段不能为空默认值为1</span></span><br><span class="line">            database.execSQL(<span class="string">&quot;ALTER TABLE word ADD COLUMN bar_data INTEGER NOT NULL DEFAULT 1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>版本更新2-3，删除了1个字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Migration</span> <span class="variable">MIGRATION_2_3</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Migration</span>(<span class="number">2</span>,<span class="number">3</span>) &#123;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">migrate</span><span class="params">(<span class="meta">@NonNull</span> SupportSQLiteDatabase database)</span> &#123;</span><br><span class="line">        database.execSQL(<span class="string">&quot;CREATE TABLE word_temp (id INTEGER PRIMARY KEY NOT NULL,english_word TEXT,&quot;</span> +</span><br><span class="line">                <span class="string">&quot;chinese_Meaning TEXT)&quot;</span>);</span><br><span class="line">        database.execSQL(<span class="string">&quot;INSERT INTO word_temp(id,english_word,chinese_Meaning)&quot;</span> +</span><br><span class="line">                <span class="string">&quot;SELECT id,english_word,chinese_Meaning FROM word&quot;</span>);</span><br><span class="line">        database.execSQL(<span class="string">&quot;Drop TABLE word&quot;</span>);</span><br><span class="line">        database.execSQL(<span class="string">&quot;ALTER TABLE word_temp RENAME to word&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure>

<p>开发阶段这么干没必要，可以直接把程序卸载，然后无论怎么改字段都可以了，也不用什么版本更新什么的。</p>
<h1 id="Bottom-Navigation-Activity底部导航"><a href="#Bottom-Navigation-Activity底部导航" class="headerlink" title="Bottom Navigation Activity底部导航"></a>Bottom Navigation Activity底部导航</h1><p>1.创建一个Menu,弄出几个item</p>
<p>Menu中的item的ID要和Frgament一致</p>
<p>2.创建几个Fragment,不需要连线</p>
<p>3.主活动中添加BottonNavigationView,将menu属性设置为自己弄出来的Menu</p>
<p>4.在主活动中添加NavHostFragment</p>
<p>主活动代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="type">BottomNavigationView</span> <span class="variable">bottomNavigationView</span> <span class="operator">=</span>findViewById(R.id.bottomNavigationView);</span><br><span class="line">        <span class="type">NavHostFragment</span> <span class="variable">navHostFragment</span> <span class="operator">=</span> (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragment);</span><br><span class="line">        <span class="type">NavController</span> <span class="variable">navController</span> <span class="operator">=</span> navHostFragment.getNavController();</span><br><span class="line">        <span class="type">AppBarConfiguration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AppBarConfiguration</span>.Builder(bottomNavigationView.getMenu()).build();</span><br><span class="line">        NavigationUI.setupActionBarWithNavController(<span class="built_in">this</span>,navController,configuration);</span><br><span class="line">        NavigationUI.setupWithNavController(bottomNavigationView,navController);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/Picture/image-20231207062228822.png" alt="image-20231207062228822" style="zoom:67%;" />

<h1 id="paging分页"><a href="#paging分页" class="headerlink" title="paging分页"></a>paging分页</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">  <span class="type">val</span> <span class="variable">paging_version</span> <span class="operator">=</span> <span class="string">&quot;3.1.1&quot;</span></span><br><span class="line"></span><br><span class="line">  implementation(<span class="string">&quot;androidx.paging:paging-runtime:$paging_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// alternatively - without Android dependencies for tests</span></span><br><span class="line">  testImplementation(<span class="string">&quot;androidx.paging:paging-common:$paging_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// optional - RxJava2 support</span></span><br><span class="line">  implementation(<span class="string">&quot;androidx.paging:paging-rxjava2:$paging_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// optional - RxJava3 support</span></span><br><span class="line">  implementation(<span class="string">&quot;androidx.paging:paging-rxjava3:$paging_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// optional - Guava ListenableFuture support</span></span><br><span class="line">  implementation(<span class="string">&quot;androidx.paging:paging-guava:$paging_version&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// optional - Jetpack Compose integration</span></span><br><span class="line">  implementation(<span class="string">&quot;androidx.paging:paging-compose:1.0.0-alpha18&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://changettto.github.io">Pn</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://changettto.github.io/2023/11/25/jetpack/">https://changettto.github.io/2023/11/25/jetpack/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://changettto.github.io" target="_blank">Rxbby</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a></div><div class="post_share"><div class="social-share" data-image="https://rxbby.oss-cn-guangzhou.aliyuncs.com/HuiYuan.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/27/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="常见设计模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">常见设计模式</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/20/Kotlin/" title="Kotlin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Kotlin</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/01/10/andriod%E5%AE%9E%E7%8E%B0/" title="安卓工具包"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-10</div><div class="title">安卓工具包</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://rxbby.oss-cn-guangzhou.aliyuncs.com/HuiYuan.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Pn</div><div class="author-info__description">不努力，枉年轻！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ChangeTTTO?tab=repositories"><i class="fab fa-github"></i><span>代码仓库</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">写写笔记和日常</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Android-Java-Version"><span class="toc-number">1.</span> <span class="toc-text">Android_Java_Version</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E4%BD%86%E4%B8%8D%E7%9F%A5%E9%81%93%E6%94%BE%E5%93%AA%E4%B8%AA%E4%BD%8D%E7%BD%AE%E7%9A%84%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">2.</span> <span class="toc-text">一些有用但不知道放哪个位置的知识补充</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Context"><span class="toc-number">3.</span> <span class="toc-text">Context</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Context%E5%92%8CApplicationContext"><span class="toc-number">3.1.</span> <span class="toc-text">Context和ApplicationContext</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Application"><span class="toc-number">4.</span> <span class="toc-text">Application</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Constraint-layout"><span class="toc-number">5.</span> <span class="toc-text">Constraint layout</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#palette%E8%B0%83%E8%89%B2%E6%9D%BF"><span class="toc-number">5.1.</span> <span class="toc-text">palette调色板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Attributes"><span class="toc-number">5.2.</span> <span class="toc-text">Attributes</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Activity-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">6.</span> <span class="toc-text">Activity 生命周期</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Activity%E6%96%B9%E6%B3%95"><span class="toc-number">7.</span> <span class="toc-text">Activity方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#onSaveInstanceState"><span class="toc-number">7.1.</span> <span class="toc-text">onSaveInstanceState</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UI%E6%8E%A7%E4%BB%B6"><span class="toc-number">8.</span> <span class="toc-text">UI控件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BAbutton%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AA%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">8.1.</span> <span class="toc-text">为button设置一个点击事件监听器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Switch%E7%9B%91%E5%90%AC%E6%94%B9%E5%8F%98%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.2.</span> <span class="toc-text">Switch监听改变事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#radioGroup%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.3.</span> <span class="toc-text">radioGroup监听事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#seekBar%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.4.</span> <span class="toc-text">seekBar监听事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#checkedBox%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.5.</span> <span class="toc-text">checkedBox监听事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#progressBar"><span class="toc-number">8.6.</span> <span class="toc-text">progressBar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Number"><span class="toc-number">8.7.</span> <span class="toc-text">Number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#imageView"><span class="toc-number">8.8.</span> <span class="toc-text">imageView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TextView-plain-View"><span class="toc-number">8.9.</span> <span class="toc-text">TextView-plain-View</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ratingBar%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.10.</span> <span class="toc-text">ratingBar监听事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ImageButton"><span class="toc-number">8.11.</span> <span class="toc-text">ImageButton</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chronometer%E8%AE%A1%E6%97%B6%E5%99%A8"><span class="toc-number">8.12.</span> <span class="toc-text">Chronometer计时器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RecyclerView"><span class="toc-number">8.13.</span> <span class="toc-text">RecyclerView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CardView"><span class="toc-number">8.14.</span> <span class="toc-text">CardView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FloatingActionButton"><span class="toc-number">8.15.</span> <span class="toc-text">FloatingActionButton</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#menu%E8%8F%9C%E5%8D%95%E5%B8%83%E5%B1%80"><span class="toc-number">8.16.</span> <span class="toc-text">menu菜单布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">8.17.</span> <span class="toc-text">属性动画</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%8A%A5%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-number">9.</span> <span class="toc-text">常见报错及解决方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9AMainActivity-java%E4%B8%AD%E9%85%8D%E7%BD%AENavController%E5%90%8E%E7%A8%8B%E5%BA%8F%E9%97%AA%E9%80%80%E3%80%82"><span class="toc-number">9.1.</span> <span class="toc-text">遇到的问题：MainActivity.java中配置NavController后程序闪退。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C%E5%BC%B9%E5%87%BA%E9%94%AE%E7%9B%98%E5%87%BA%E7%8E%B0%E5%AF%BC%E8%87%B4%E8%A7%86%E5%9B%BE%E8%A2%AB%E5%8E%8B%E7%BC%A9%E9%82%A3%E4%B9%88%E5%BA%94%E8%AF%A5"><span class="toc-number">9.2.</span> <span class="toc-text">如果弹出键盘出现导致视图被压缩那么应该</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A2%E9%87%8F%E5%9B%BE"><span class="toc-number">9.3.</span> <span class="toc-text">矢量图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#res"><span class="toc-number">10.</span> <span class="toc-text">res</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E6%94%B6%E9%9B%86"><span class="toc-number">11.</span> <span class="toc-text">方法收集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Toast-makeText%EF%BC%88%EF%BC%89"><span class="toc-number">11.1.</span> <span class="toc-text">Toast.makeText（）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#context-getResources-getString-R-string-MY-DATA"><span class="toc-number">11.2.</span> <span class="toc-text">context.getResources().getString(R.string.MY_DATA);</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TextUtils-isEmpty"><span class="toc-number">11.3.</span> <span class="toc-text">TextUtils.isEmpty()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#View-OnClickListener"><span class="toc-number">11.4.</span> <span class="toc-text">View.OnClickListener</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#view-getId"><span class="toc-number">11.5.</span> <span class="toc-text">view.getId()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getString"><span class="toc-number">11.6.</span> <span class="toc-text">getString</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B1%8F%E5%B9%95%E6%96%B9%E5%90%91%E6%97%8B%E8%BD%AC"><span class="toc-number">12.</span> <span class="toc-text">屏幕方向旋转</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E5%B1%8F%E5%B9%95%E6%97%8B%E8%BD%AC%E4%BA%86%E5%BA%94%E7%94%A8%E5%86%85%E5%AE%B9%E4%B8%8D%E4%BC%9A%E8%B7%9F%E7%9D%80%E5%8F%98%E5%8C%96%E3%80%82"><span class="toc-number">12.1.</span> <span class="toc-text">如何使屏幕旋转了应用内容不会跟着变化。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E7%AB%96%E7%9B%B4%E8%B7%9F%E6%A8%AA%E5%90%91%E4%B8%A4%E4%B8%AA%E6%A8%A1%E5%BC%8F%E5%81%9A%E4%B8%A4%E7%A7%8D%E5%B8%83%E5%B1%80"><span class="toc-number">12.2.</span> <span class="toc-text">为竖直跟横向两个模式做两种布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Model-View-Controller"><span class="toc-number">12.3.</span> <span class="toc-text">Model-View-Controller</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#View-model"><span class="toc-number">13.</span> <span class="toc-text">View-model</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E4%BF%9D%E5%AD%98-%E5%A6%82%E4%BD%95%E5%9C%A8%E7%B3%BB%E7%BB%9F%E6%9D%80%E6%AD%BB%E5%BA%94%E7%94%A8%E4%B9%8B%E5%90%8E%E5%BA%94%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BF%98%E6%98%AF%E8%83%BD%E5%A4%9F%E5%BE%97%E5%88%B0%E4%BF%9D%E5%AD%98"><span class="toc-number">13.1.</span> <span class="toc-text">状态保存-如何在系统杀死应用之后应用的数据还是能够得到保存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B0%B8%E4%B9%85%E4%BF%9D%E5%AD%98"><span class="toc-number">13.2.</span> <span class="toc-text">数据永久保存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#getPreferences-int-mode"><span class="toc-number">13.2.1.</span> <span class="toc-text">getPreferences(int mode)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getSharedPreferences-String-name-int-mode"><span class="toc-number">13.2.2.</span> <span class="toc-text">getSharedPreferences(String name, int mode)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AndroidViewModel%E5%B0%86v-model%E6%95%B0%E6%8D%AE%E5%92%8CSharedPreference%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%AE%8C%E6%88%90%E6%8C%81%E4%B9%85%E5%8C%96%E6%93%8D%E4%BD%9C%E7%9A%84%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B"><span class="toc-number">13.2.3.</span> <span class="toc-text">AndroidViewModel将v-model数据和SharedPreference进行关联完成持久化操作的完整示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LiveData"><span class="toc-number">14.</span> <span class="toc-text">LiveData</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Data-Binding%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-number">15.</span> <span class="toc-text">Data Binding数据绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%86%E5%8F%AF%E8%A7%82%E5%AF%9F%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%88%B0%E7%95%8C%E9%9D%A2%E5%85%83%E7%B4%A0-view%E2%80%93-Binding"><span class="toc-number">15.1.</span> <span class="toc-text">将可观察数据绑定到界面元素.  view–&gt;Binding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Binding%E2%80%93-view"><span class="toc-number">15.2.</span> <span class="toc-text">Binding–&gt;view</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B2%BE%E7%AE%80%E5%90%8E%E7%9A%84%E4%B8%BB%E6%B4%BB%E5%8A%A8"><span class="toc-number">15.2.1.</span> <span class="toc-text">精简后的主活动</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Navigation%E5%AF%BC%E8%88%AA"><span class="toc-number">16.</span> <span class="toc-text">Navigation导航</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E4%B8%BB%E6%B4%BB%E5%8A%A8%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%AF%BC%E8%88%AA%E5%B9%B6%E5%9C%A8%E5%B7%A6%E4%B8%8A%E8%A7%92%E6%B7%BB%E5%8A%A0%E8%BF%94%E5%9B%9E%E7%AE%AD%E5%A4%B4"><span class="toc-number">16.1.</span> <span class="toc-text">在主活动中使用导航并在左上角添加返回箭头</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BC%A0%E9%80%92"><span class="toc-number">16.2.</span> <span class="toc-text">导航中数据的传递</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tween-animation-%E5%85%B3%E9%94%AE%E5%B8%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">16.3.</span> <span class="toc-text">tween animation 关键帧动画</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E5%A5%BD%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E6%96%B9%E5%BC%8Fv-mod-nav-Fragment"><span class="toc-number">16.4.</span> <span class="toc-text">更好的数据传递方式v-mod-nav-Fragment</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lifeCycles"><span class="toc-number">17.</span> <span class="toc-text">lifeCycles</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Room"><span class="toc-number">18.</span> <span class="toc-text">Room</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Entity-Dao-Database%E4%BE%8B%E5%AD%90"><span class="toc-number">18.1.</span> <span class="toc-text">Entity.Dao.Database例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Async-Task-Repository-View-Model-LiveData%E4%BE%8B%E5%AD%90"><span class="toc-number">18.2.</span> <span class="toc-text">Async Task-Repository-View_Model-LiveData例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RecyclerView%E5%91%88%E7%8E%B0%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">18.3.</span> <span class="toc-text">RecyclerView呈现列表数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86"><span class="toc-number">18.4.</span> <span class="toc-text">数据库的版本管理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bottom-Navigation-Activity%E5%BA%95%E9%83%A8%E5%AF%BC%E8%88%AA"><span class="toc-number">19.</span> <span class="toc-text">Bottom Navigation Activity底部导航</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#paging%E5%88%86%E9%A1%B5"><span class="toc-number">20.</span> <span class="toc-text">paging分页</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/22/gradle%20Connection%20time%20out%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="gradle构建超时gradle connection timed out解决方案">gradle构建超时gradle connection timed out解决方案</a><time datetime="2024-01-22T08:04:01.000Z" title="发表于 2024-01-22 16:04:01">2024-01-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/19/NewsApi/" title="无题">无题</a><time datetime="2024-01-19T10:23:53.674Z" title="发表于 2024-01-19 18:23:53">2024-01-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/18/Docker%E7%9A%84%E5%AE%89%E8%A3%85/" title="Docker的安装">Docker的安装</a><time datetime="2024-01-17T21:18:54.000Z" title="发表于 2024-01-18 05:18:54">2024-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/17/Ant-Design-pro%E5%88%A0%E9%99%A4%E5%9B%BD%E9%99%85%E5%8C%96%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="Ant-Design-pro删除国际化失败解决方案">Ant-Design-pro删除国际化失败解决方案</a><time datetime="2024-01-17T08:04:01.000Z" title="发表于 2024-01-17 16:04:01">2024-01-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/17/SpringBoot%E7%A6%81%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93/" title="SpringBoot项目禁用数据库">SpringBoot项目禁用数据库</a><time datetime="2024-01-17T06:25:39.000Z" title="发表于 2024-01-17 14:25:39">2024-01-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Pn</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><div class="aplayer" data-id="1336871887" data-server="netease" data-type="song"  data-fixed="true" data-theme="#3F51B5" ></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>